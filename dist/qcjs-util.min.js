/* ! qcjs (c) 老李 (20390965@qq.com) v0.2.0 */
qc.c={},qc.icon={},qc.lang={},qc.util={_mobile:!1,_starts:[],_inited:[],init:function(){if(0==arguments.length){var t,e=[];for(t in qc.util.on(),qc.c){var c=qc.c[t];qc[t]=c,e.push(c)}qc.util.setIconStyle(),qc.util.starts(),qc.util.langInit(function(){qc.util.creates(e),qc.util.initeds(e)})}else for(var a=0;a<arguments.length;a++){var r=qc(arguments[a]);(c=qc.util.convert2fnc("qc."+r.attr("qc-control")+".create"))&&c(r)}},convert2fnc:function(t){var e;try{"string"==typeof t?t.match(/^[\w\d_\$\.]+$/)&&(e=Function("return ("+t+")")()):"object"==typeof t&&t.attr("qc-fn")?e=qc.util.convert2fnc(t.attr("qc-fn")):"function"==typeof t&&(e=t)}catch(t){}return e},fnc:function(t){var e=!0,c="string"==typeof t?t:t.fn,c=qc.util.convert2fnc(c),t="object"==typeof t?{contrl:t.contrl,curr:t.curr,ev:t.ev}:t;return e=c?c(t):e},on:function(){qc.util.mobile();var t=qc(document);t.on("click",qc.util.event),t.on("change",qc.util.event),qc(window).on("resize",qc.util.resize),qc(window).on("load",qc.util.resize)},start:function(t){"function"==typeof t&&qc.util._starts.push(t)},creates:function(t){t.each(function(t){t.create&&(t.control?qc("[qc-control='"+t.control+"']").each(function(){t.create(qc(this))}):t.create())})},addInited:function(t){"function"==typeof t&&qc.util._inited.push(t)},initeds:function(t){t.push.apply(t,qc.util._inited),t.each(function(t){t.init?t.init():"function"==typeof t&&t()})},starts:function(){qc.util._starts.each(function(t){t()})},event:function(t){var e=!0;"change"==t.type&&qc.util.getVal(qc(t.target));var c=qc.util.find(qc(t.target),t);return c.fn&&(e=qc.util.fnc(c)),qc.util.hideObj.remove(t),e},find:function(t,e){var c=t.closest("[qc-control]"),a=t,r=a.attr("qc-fn"),n=a.attr("qc-for"),i=e.type.toLowerCase(),t=a.attr("qc-type"),o=QCSet();if("change"==i&&o.add(i),t&&(t=t.trim(),o.add(t.split(/\s+/))),n&&"change"!=i)r="qc."+n+".show";else{for(;0==o.length&&!r&&0!=(a=a.parent()).length;)a.attr("qc-type")&&o.add(a.attr("qc-type")),r=a.attr("qc-fn");0<o.length&&r?r=o.contains(i)?r:"":0<c.length&&0<o.length&&!r&&(("change"!=(n=o[0])||"change"==n&&i==n)&&(r="qc."+c.attr("qc-control")+"."+o[0]))}return{contrl:c,curr:a,fn:r,ev:e}},hideObj:{hides:QCSet(),set:function(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);qc.util.hideObj.hides.add(t)},remove:function(c){qc.util.hideObj.hides.each(function(t){var e=!1;t.each(function(t){t=qc(t);e=e||c.pageX>=t.offset().left&&c.pageX<=t.offset().left+t.width()&&c.pageY>=t.offset().top&&c.pageY<=t.offset().top+t.height()}),e||(qc(t[0]).hide(),qc.util.hideObj.hides.remove(t))})}},resize:function(){qc.util.mobile()},mobile:function(){var t,e=!1;e="maxTouchPoints"in navigator?0<navigator.maxTouchPoints:"msMaxTouchPoints"in navigator?0<navigator.msMaxTouchPoints:(t=window.matchMedia&&matchMedia("(pointer:coarse)"))&&"(pointer:coarse)"===t.media?!!t.matches:"orientation"in window||(t=navigator.userAgent,/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(t)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(t)),qc.util._mobile=e},isMobile:function(){return qc.util._mobile},getFields:function(e,t,c){c=c||{},t?t.split(",").each(function(t){t=t.trim();t=e.attr(t);t&&t.split(",").each(function(t){t=t.trim(),qc.util.getVal(e.find("[qc-field='"+t+"']"),c)})}):e.find("[qc-field]").each(function(){qc.util.getVal(qc(this),c)});var a=QCSet(c.key),t=e.attr("qc-key");return t&&a.add(t.split(",")),c.key=a.join(","),c},getVal:function(t,e){var c,a,r,n,i=void 0;return t[0]&&(r=t[0].tagName.toLowerCase(),c=t.attr("type")||r,a=t.attr("qc-field"),r=qc[t.attr("qc-control")],["hidden","text","password","select","textarea"].contains(c)?(i=t.val(),t.attr("qc-value",i)):i=["checkbox","radio"].contains(c)?t.is(":checked")?t.val():t.attr("qc-default"):"file"==c?t[0]:r&&r.val?r.val(t):((r=t.find("[qc-subfield]"))[0]&&(n=[],r.each(function(){var t=qc(this).attr("qc-value");n.push(t)}),t.attr("qc-value",n.join("&"))),t.attr("qc-value")),e&&a&&null!=i&&((t=e[a])?Array.isArray(t)?t.contains(i)||t.push(i):i&&t!=i&&(e[a]=[t,i]):e[a]=i)),i},setDatas:function(t,e){for(var c in e)qc.util.setData(t,c,e[c])},setData:function(t,e,c){var a,r=t.find("[qc-field='"+e+"']");r[0]&&(r.attr("qc-value",c),r.is("[qc-control='selector']")?qc.selector.val(r,c):r.is("[type='checkbox']")||r.is("[type='radio']")?c==r.attr("qc-default")?r.removeAttr("checked"):r.attr("checked","checked"):(e=r.attr("type")||r[0].tagName.toLowerCase(),["hidden","text","password","select","textarea"].contains(e)?r.val(c):(a=(c+"").split("&")).each(function(t){t=decodeURI(decodeURI(t)),1==a.length?r.html(t):r.append("<span qc-subfield qc-value='"+t+"'>"+t+"</span>")})))},setDefualt:function(t,e,c){var a,r={};for(a in"object"==typeof e?r=e:r[e]=c,r){var n=t.find("[qc-field='"+a+"']");n[0]&&(n.attr("qc-default",r[a]),n.removeAttr("qc-value"),n[0].value?n.val(""):n.html(""))}},initData:function(c,t){c.find("[qc-field]").each(function(){var t=qc(this).attr("qc-default"),e=qc(this).attr("qc-field");null!=t&&qc.util.setData(c,e,t)})},get:function(t,e,c){qc.util.postData("qc-get",t,e,c)},post:function(t,e,c){qc.util.postData("qc-post",t,e,c)},upload:function(t,e,c){qc.util.postData("qc-upload",t,e,c)},postData:function(t,e,c,a){"function"==typeof c&&(a=c,c={});var r=qc.util.parseArgs(t,e,c),e=r.fn;e&&("string"==typeof e?qc._post(e,c,function(t){qc.util.postBack(t,r.re,a)}):e(r.re,function(t){qc.util.postBack(t,r.re,a)}))},parseArgs:function(t,e,c){var a,r,n,i;return"string"==typeof e?n=qc.util.convert2fnc(e)||e:(a="qc-key, qc-need",(e=(r=(i=e).closest("[qc-control]")).parent().closest("[qc-control]"))[0]&&qc.util.getFields(e,a,c),r[0]&&qc.util.getFields(r,a,c),qc.util.getVal(i,c),i.attr(t)?n=i.attr(t):r[0]&&r.attr(t)?n=r.attr(t):e[0]&&e.attr(t)&&(n=e.attr(t)),n=qc.util.convert2fnc(n)||n,i={contrl:r,curr:i,args:c}),{fn:n,re:i}},postBack:function(t,e,c){try{t=JSON.parse(t)}catch(t){}c&&c(t,e)},setLangDir:function(t){qc.util._langDir=t},getLangDir:function(){return qc.util._langDir},setLangGlobal:function(t){t&&(qc.util._langGlobal=t)},getLangGlobal:function(){return qc.util._langGlobal},setLangName:function(t){qc.util._langName=t},getLangName:function(){return qc.util._langName},langInit:function(t,e){"function"==typeof t&&(e=t,t=void 0),qc.util._langDir||(qc.util._langDir=qc("html").attr("qc-lang-dir")||"lang"),qc.util._langName=t||qc("html").attr("lang"),qc.util.langGlobal(function(){var t;qc.util._langName?((t=qc.util._langName).match(/.*\.js$/)||(t+=".js"),t=qc.util._langDir+"/"+t,qc.getScript(t,function(){qc.util.langReset(),e&&e()})):e()})},langGlobal:function(t){var e;qc.util._langGlobal||(qc.util._langGlobal=qc("html").attr("qc-lang-global")),qc.util._langGlobal?((e=qc.util._langGlobal).match(/.*\.js$/)||(e+=".js"),e=qc.util._langDir+"/"+e,qc.getScript(e,t)):t()},lang:function(e,t,c,a){var r;c=c||"title",a||(r=e.closest("[qc-control]"))[0]&&(a=r.attr("qc-control"));var n,a=qc.lang[a];!a||(n=a[t]||t)&&c.split(",").each(function(t){"html"==(t=t.trim())?e.html(n):e.attr(t,n)})},langReset:function(){qc("[qc-lang]").each(function(){var t=qc(this),e=t.attr("qc-lang"),c=t.attr("qc-lang-name"),a=t.attr("qc-lang-attr");qc.util.lang(t,c,a,e)})},icon:function(t,e,c){var a;c||(a=t.closest("[qc-control]"))[0]&&(c=a.attr("qc-control"));c=qc.icon[c];!c||(e=c[e]||e)&&(qc.iconStyle?t.prepend(qc(qc.iconStyle).addClass(e)):t.addClass(e))},setIconStyle:function(t){qc.iconStyle=t||"<i class='fa'>"}},qc(function(){qc.util.init()}),qc.c.popfrm={control:"popfrm",create:function(t){var e,c,a,r,n,i=qc(t);0!=i.length&&(i.hide(),e=i.find("[qc-warp]"),c=i.find("[qc-container]"),a=i.find("[qc-content]"),r=i.attr("qc-buttons"),n=i.attr("qc-title"),t=i.attr("qc-content"),0==e.length&&(e=qc("<div class='qc-warp' qc-warp>"),i.prepend(e)),0==c.length&&(c=qc("<div class='qc-container' qc-container>"),i.append(c)),(r||n)&&qc.popfrm.createToolbar(n,r,c),0==a.length&&(a=qc("<div class='qc-content' qc-content>"),c.append(a)),t&&a.html(t),0==c.find("[qc-buttons] a").length&&e.attr("qc-type","hide"))},show:function(t){var e=t.curr,c=qc(e.attr("qc-target")),a=e.attr("qc-fn"),r=e.attr("qc-post");if(c[0]){c[0].origin=e,c[0].isHide=!0,r&&(c[0].hideCallee=qc.util.convert2fnc(r)),c.show();var n=qc.util.convert2fnc(a);n&&n(c),qc.popfrm.layout(c)}else{for(var t=e.attr("qc-title"),n=e.attr("qc-buttons"),c=e.contents(),i=e.attr("qc-content")||"",o=c[0];o;)8==o.nodeType&&(i+=o.textContent+"\n"),o=o.nextSibling;qc.popfrm.dyShow(t,n,i,e,a,r)}},dyShow:function(t,e,c,a,r,n){var i=qc("<div class='qc-popfrm' qc-control='popfrm'>"),o=qc("<div class='qc-container' qc-container>"),d=qc("<div class='qc-warp' qc-warp>");qc("body").append(i),i.append(d).append(o),0==qc.popfrm.createToolbar(t,e,o)&&d.attr("qc-type","hide");d=qc("<div class='qc-content' qc-content>");o.append(d),"object"==typeof c&&c.src&&(i[0].src=c.src,d.addClass("qc-popfrm-iframe"),d.append("<iframe src='"+c.src+"'>")),"string"==typeof c&&d.append(c),i[0].origin=a,i[0].isHide=!1,n&&(i[0].hideCallee=n),i.show(),r&&r(i),qc.popfrm.layout(i)},createToolbar:function(t,e,c){var a=c.find("[qc-toolbar]"),r=0;return(t||e)&&(a[0]||(a=qc("<div class='qc-toolbar' qc-toolbar>"),c.prepend(a)),(c=a.find("[qc-title]"))[0]||(c=qc("<span class='qc-title' qc-title>"),a.append(c)),t=t||qc.lang.popfrm.title,c.html(t),r=qc.popfrm.createButtons(e,a)),r},createButtons:function(t,e){if(!t)return 0;var c,a={cancel:{title:qc.lang.popfrm.cancel,icon:"close",text:"",type:"hide"},ok:{title:qc.lang.popfrm.ok,icon:"ok"}},r=[],n=a.cancel,t="string"==typeof t?t.split(" "):t;return t.each(function(t){var e;"object"==typeof(t="string"==typeof t&&"cancel"!=t?a[t]:t)&&(e=t.name,t=qc._extend(t,a[e]),"cancel"==e?n=t:r.push(t))}),r.push(n),0<r.length&&((c=e.find("[qc-buttons]"))[0]||(c=qc("<div class='qc-buttons' qc-buttons>"),e.append(c),c.empty()),r.each(function(t){var e=qc("<a href='javascript:void(0);'>");c.append(e),e.attr("qc-type",("cancel"!=t.name||!t.fn)&&t.type||""),qc.util.lang(e,t.title,"title"),t.fn&&e.attr("qc-fn",t.fn),t.text&&(qc.util.lang(e,t.text,"html"),e.prepend("&nbsp;")),t.icon&&qc.util.icon(e,t.icon),t.title&&e.attr("title",t.title)})),r.length},hide:function(t){t.contrl[0].hideCallee&&t.contrl[0].hideCallee(),qc.popfrm.hidden(t.contrl)},hidden:function(t){t[0].isHide?t.hide():t.remove()},layout:function(e){var t,c,a,r,n=e[0].origin,i=e[0].ownerDocument.documentElement,o=e.find("[qc-container]"),d=e.find("[qc-warp]"),l=e.find(".qc-popfrm-iframe"),s="absolute";!n||e[0].src?(r=t="5%",a=c="15%"):qc.util.isMobile()?(s="relative",c=d.height()/2-o.height()/2+"px"):n[0]&&(c=n.offset().top+n.height()-i.scrollTop,t=n.offset().left,c>d.height()/2&&(c=c-o.height()-n.height()),t>d.width()/2&&(t-=o.width()),c+="px",t+="px"),o.css({position:s,top:c||"auto",left:t||"auto",right:r||"auto",bottom:a||"auto"}),l[0]&&l.css("height","calc(100% - "+e.find(".qc-toolbar").outerHeight()+"px"),e.attr("tabindex",0),e.focus(),e.on("keyup",function(t){if("Escape"==t.key)return qc.popfrm.hide({contrl:e}),!1})}},qc.c.selector={control:"selector",create:function(t){t=qc(t);0!=t.length&&qc.selector.createBox(t)},createBox:function(e){var c=qc("<div>");if(e[0].getAttributeNames)e[0].getAttributeNames().each(function(t){c.attr(t,e.attr(t))});else for(var t=e[0].attributes,a=0;a<t.length;a++)c.attr(t[a].name,t[a].value);e.before(c),c.addClass("qc-selector"),c.attr("qc-type","show"),qc.selector.initData(c,e);var r=qc("<input type='text' class='qc-selector-text' qc-content readonly>"),n=qc("<a href='javascript:void(0);' class='qc-selector-caret'></a>"),i=qc("<ul qc-selector-list>");c.append(n).append(r).append(i);var o=c.attr("qc-title"),d=c.attr("qc-icon");r.attr("title",o||""),qc.util.icon(n,d||"caret");d=c.attr("qc-mode")||"auto";c[0].mode=d.contains("normal")?"":"auto",d.contains("search")?(c[0].seMode="search",c[0].search=""):c[0].seMode="",c[0].seMode&&(r.attr("placeholder",o||""),r.removeAttr("readonly"),r.change(function(t){return!1})),r.attr("qc-type","show"),i.hide(),c.on("keyup",qc.selector.keyup)},initData:function(t,e){var r=[],n=t.attr("qc-field")||"v",i=t.attr("qc-text")||n;e.find("option").each(function(){var t=qc(this),e=t.text(),c=!0,a={};a[n]=t.attr("value"),e.split(",").each(function(t){t=t.trim();t=/^([^=]+)=(.+)$/.exec(t);t&&(a[t[1]]=t[2],c=!1)}),c&&(a[i]=e),r.push(a)}),t[0].data={rows:r.length,data:r},e.remove()},init:function(){qc.selector.getDatas()},getDatas:function(e){var t,c=e?(t=e.filter("[qc-for]"),e):(t=qc("[qc-control='selector'][qc-for]"),qc("[qc-control='selector']"));t.each(function(){var t=qc(this),e=qc(t.attr("qc-for"));t[0].frEl=e[0],e[0].orEl=t[0]}),c.each(function(){var t;this.orEl||!e&&"auto"!=this.mode||(t=qc(this),qc.selector.getData(t))})},getData:function(t,e){var c={};t[0].orEl&&qc.util.getVal(qc(t[0].orEl),c),t[0].search&&(c[t.attr("qc-search-key")||"search_key"]=t[0].search),qc.selector.get(t.attr("qc-get"),t,c,e)},get:function(t,e,c,a){var r;t?(r=e.attr("qc-get"),e.attr("qc-get",t),c.count=e.attr("qc-count")||0,c.page=c.count?1:0,qc.util.get(e,c,function(t){e.attr("qc-get",r),e[0].data=t,qc.selector.fillData(e,a)})):qc.selector.fillData(e,a)},fillData:function(t,e){t.find("ul").empty();for(var c=t[0].data,a=t.attr("qc-field")||"v",r=(t.attr("qc-text")||a).split(","),n=(t.attr("qc-buttons")||"").split(","),i=t.find("ul"),o=0;o<c.rows;o++){var d=c.data[o],l=[],s=[];r.each(function(t){t=t.trim();var e=d[t];l.push(null==e?t:e)}),n.each(function(t){var e=t.split("|"),c=e[0],a=e[1],r=e[3],t=e[2];if(1==e.length&&!c)return!0;c=qc("<a href='javascript:void(0);' class='qc-button'>"+c+"</a>");a&&qc.util.icon(c,a,"selector"),t&&c.attr("title",t),r&&c.attr("qc-fn",r),s.push(c)});var q=l.join(" "),f=qc("<li tabindex='"+o+"'>"+q+"</li>");f.attr("qc-value",d[a]),f.attr("qc-text",q),f.attr("qc-type","select"),0<s.length&&((q=qc("<div class='qc-buttons'>")).append(s),f.append(q)),i.append(f)}var p=t.attr("qc-default"),u=t.find("li"),h=u.filter("[qc-value='"+p+"']");null==p&&null==t[0].search&&(h=u.eq(0)),qc.selector.selected({contrl:t,curr:h}),e?e(t):(e=qc.util.convert2fnc(t.attr("qc-fn")))&&e(t)},show:function(t,e){var c=t.contrl||t;e?(c[0].data=e,qc.selector.fillData(c),qc.selector.shown(c)):c[0].seMode?(t.curr=c.find("[qc-content]"),qc.selector.search(t,qc.selector.shown)):qc.selector.shown(c)},shown:function(t){var e=t.find("ul");e.show(),qc.util.hideObj.set(e,t),e.css({left:"0px",top:t.height()+"px","min-width":t.width()+"px"});t=e.find("li.selected");0<t.length&&(e[0].scrollTop=t[0].offsetTop)},select:function(t){qc.selector.selected(t);var e=t.contrl.find("ul");qc.util.hideObj.hides.each(function(t){t[0].equals(e)&&(e.hide(),qc.util.hideObj.hides.remove(t))}),qc.selector.change(t)},selected:function(t){var e=t.contrl,c=t.curr,a=c[0]?c.attr("qc-text"):"",r=c[0]?c.attr("qc-value"):"";e.find("li").removeClass("selected"),c[0]&&(c.addClass("selected"),e.find("[qc-content]").val(a)),e.attr("qc-value",r),e[0].seMode&&!t.ev||qc.selector.for(e)},change:function(c,a){qc.selector.post(c.contrl,function(t){var e=c.contrl.closest("[qc-control='editor']");0<e.length?qc.editor.change({contrl:e,curr:c.contrl},a):a&&a(t,c)})},post:function(t,c){t.attr("qc-post")&&qc.util.post(t,function(t,e){c&&c(t,e)})},for:function(t){t=t.attr("qc-for");t&&((t=qc(t)).find("[qc-content]").val(""),qc.selector.getData(t))},search:function(t){var e=t.contrl||t,t=t.curr||t.find("[qc-content]");e[0].search=t.val(),qc.selector.getData(e,qc.selector.shown)},val:function(t,e){var c;return null==e?e=t.attr("qc-value"):(e||t[0].search||(t[0].search=void 0),(c=t.find("li[qc-value='"+e+"']"))[0]?qc.selector.selected({contrl:t,curr:c}):t[0].seMode&&(t.attr("qc-value",e),t.find("[qc-content]").val(e))),e},text:function(t,e){if(null==e)return t.find("[qc-content]").val();t.find("[qc-content]").val(e)},addItem:function(t,e,c){var a,r=(t="string"==typeof t?qc(t):t)[0].data,n=r.data;Array.isArray(e)?n=n.concat(e):((a={})[t.attr("qc-field")]=e,a[t.attr("qc-text")]=c,n.push(a)),r.data=n,r.rows=n.length,qc.selector.getDatas(t)},removeItem:function(t,e){var c=[];Array.isArray(e)?c=c.concat(e):c.push(e);var t=t[0].data,a=t.data;c.each(function(t){a.splice(t,1)}),t.rows=a.length},focus:function(t){t.find("[qc-content]").focus()},keyup:function(t){var e,c,a=qc(this),r=qc(t.target),n=t.key;r.is("[qc-content]")?"Enter"==n?1==(e=a.find("li")).length&&qc.selector.select({contrl:a,curr:e,ev:t}):"ArrowDown"==n?(e=a.find("li"))[0]&&e.focus():"ArrowUp"==n||qc.selector.show({contrl:a,curr:r,ev:t}):r.is("li")&&("ArrowDown"==t.key?(c=r.next())[0]&&c.focus():"ArrowUp"==t.key?((c=r.prev())[0]?c:a.find("[qc-content")).focus():"Enter"==t.key&&r.click())}},qc.c.colorpicker={control:"colorpicker",show:function(t){var e=t.curr,c=e.attr("qc-colorpicker-mode"),a=e.attr("qc-colorpicker-css")||"color",r=e.attr("qc-target")?qc(e.attr("qc-target")):e,t=r.css(a);qc.colorpicker.dyShow(e,t,c,function(t){r.css(a,t)})},dyShow:function(t,e,c,a){qc.popfrm.dyShow(qc.lang.colorpicker.title,[{name:"ok",fn:"qc.colorpicker.confirm"}],"",t,function(t){t[0].callee=a,t.addClass("qc-colorpicker");t=t.find("[qc-content]");qc.colorpicker.createContent(t,e,c,a)})},createContent:function(t,e,c,a){"panel"==(c=c||(qc.util.mobile?"list":"panel"))&&(qc.colorpicker.createPanel(t),qc.colorpicker.initContent(t,e)),"list"==c&&qc.colorpicker.createList(t,e)},createPanel:function(t){t.css("padding",0),t.append("<div class='qc-colorpicker-panel'>   <canvas width='256' height='126'></canvas>   <div class='qc-colorpicker-panel-pick'></div> </div><div class='qc-colorpicker-bar'>   <div class='qc-colorpicker-cur'></div>   <canvas width='160' height='12' class='qc-colorpicker-color'></canvas>   <div class='qc-colorpicker-bar-pick'></div>    <div style='width: 160px; height: 12px;' class='qc-colorpicker-a-back'></div>   <canvas width='160' height='12' class='qc-colorpicker-a'></canvas>   <div class='qc-colorpicker-bar-pick-a'></div> </div><div class='qc-colorpicker-textbox'>   <div><input type='text' class='qc-colorpicker-hex'></div>   <div>HEX</div>   <div>       <input type='text' class='qc-colorpicker-rgb'>       <input type='text' class='qc-colorpicker-rgb'>       <input type='text' class='qc-colorpicker-rgb'>       <input type='text' class='qc-colorpicker-rgb'>   <div>       <div class='qc-colorpicker-rgb-text'>R</div>       <div class='qc-colorpicker-rgb-text'>G</div>       <div class='qc-colorpicker-rgb-text'>B</div>       <div class='qc-colorpicker-rgb-text'>A</div></div></div>"),t.find(".qc-colorpicker-panel")[0].onselectstart=function(){return!1},t.find(".qc-colorpicker-bar")[0].onselectstart=function(){return!1}},initContent:function(e,t){qc.colorpicker.drawBar(e),t=t&&"transparent"!=t?t:"rgba(0,0,0,0)",e[0].rgba=qc.colorpicker.str2rgba(t);t=e.find(".qc-colorpicker-panel");qc.colorpicker.event(t,qc.colorpicker.setPanelPickP);t=e.find(".qc-colorpicker-bar");qc.colorpicker.event(t,qc.colorpicker.setBarPickP),e.find(".qc-colorpicker-hex, .qc-colorpicker-rgb").change(function(t){var c;qc(this).is(".qc-colorpicker-hex")&&(e[0].rgba=qc.colorpicker.str2rgba(this.value)),qc(this).is(".qc-colorpicker-rgb")&&(c=[],e.find(".qc-colorpicker-rgb").each(function(t){var e=this.value.trim();0==e.length&&(e=0),c[t]=e}),e[0].rgba.r=c[0],e[0].rgba.g=c[1],e[0].rgba.b=c[2],e[0].rgba.a=c[3]),qc.colorpicker.setBarPick(e),qc.colorpicker.setPanelPick(e),qc.colorpicker.setTextBox(e)}),qc.colorpicker.setBarPick(e),qc.colorpicker.setPanelPick(e),qc.colorpicker.setTextBox(e)},drawBar:function(t){var e=["#f00","#f0f","#00f","#0ff","#0f0","#ff0","#f00"],c=t.find(".qc-colorpicker-color"),a=c.width(),t=c.height(),c=c[0].getContext("2d"),r=c.createLinearGradient(1,0,a-1,0),n=e.length-1;e.each(function(t,e){r.addColorStop(e/n,t)}),c.fillStyle=r,c.fillRect(0,0,a,t)},event:function(a,r){a.on("mousedown",function(t){var e=qc(t.target);function c(t){r(a,t.pageX,t.pageY),t.preventDefault()}(e.hasClass("qc-colorpicker-bar-pick")||e.hasClass("qc-colorpicker-bar-pick-a")||e.hasClass("qc-colorpicker-panel-pick")||e.is("canvas"))&&(a.tar=e,r(a,t.pageX,t.pageY),qc(document).on("mousemove",c,!1),qc(document).on("mouseup mouseleave",function t(e){qc(document).off("mousemove",c,!1);qc(document).off("mouseup",t,!1)},!1))})},setPanelPickP:function(t,e,c){var a=t.find(".qc-colorpicker-panel-pick"),r=e-t.offset().left,n=c-t.offset().top,i=t.find("canvas"),o=i[0].width,d=i[0].height,e=t.closest("[qc-content]"),r=Math.max(0,Math.min(r,o)),n=Math.max(0,Math.min(n,d)),c=e[0].rgba,t=200<=c.r&&200<=c.g&&200<=c.b?"#000":"#fff";a.css({left:r-a.width()/2+"px",top:n-a.height()/2+"px","box-shadow":"0 0 2px 2px "+t});i=i[0].hsba;i.s=100*r/o,i.b=100-100*n/d,i.a=c.a,e[0].rgba=qc.colorpicker.hsba2rgba(i),qc.colorpicker.setTextBox(e)},setBarPickP:function(t,e,c){var a,r=t.tar,n=!1;r.hasClass("qc-colorpicker-color")||r.hasClass("qc-colorpicker-bar-pick")?a=t.find(".qc-colorpicker-bar-pick"):(a=t.find(".qc-colorpicker-bar-pick-a"),n=!0);var i,o=t.find("canvas").eq(n?1:0),r=e-t.offset().left,e=o[0].width,t=t.closest("[qc-content]"),r=Math.max(o[0].offsetLeft,Math.min(r,e+o[0].offsetLeft));a.css({left:r-a.width()/2+"px"}),n?(i=((r-o[0].offsetLeft)/e).toFixed(2),t[0].rgba.a=i=1==(i=0==i?0:i)?1:i):((i=qc.colorpicker.rgba2hsba(t[0].rgba)).h=360-360*(r-o[0].offsetLeft)/e,t[0].rgba=qc.colorpicker.hsba2rgba(i),qc.colorpicker.drawPanel(t,i)),qc.colorpicker.setTextBox(t)},setBarPick:function(t){var e=t.find(".qc-colorpicker-bar-pick"),c=t.find(".qc-colorpicker-bar-pick-a"),a=t.find(".qc-colorpicker-bar canvas"),r=a[0].width,n=a[0].offsetLeft,i=qc.colorpicker.rgba2hsba(t[0].rgba),r=(360-i.h)/360*r+n-e.width()/2,n=a[1].width/255*(255*i.a)+n-c.width()/2;qc.colorpicker.drawPanel(t,i),e.css("left",r+"px"),c.css("left",n+"px")},drawPanel:function(t,e){var c=t.find(".qc-colorpicker-panel canvas"),a=c[0].getContext("2d"),r=c[0].width,n=c[0].height;e.s=100,e.b=100,e.a=1;var i=qc.colorpicker.hsba2rgba(e),o=qc.colorpicker.rgba2str(i);c[0].hsba=e;e=a.createLinearGradient(3,0,r-3,0);e.addColorStop(0,"#fff"),e.addColorStop(1,o),a.fillStyle=e,a.fillRect(0,0,r,n);e=a.createLinearGradient(0,3,0,n-3);e.addColorStop(0,"rgba(0, 0, 0, 0)"),e.addColorStop(1,"rgba(0, 0, 0, 1)"),a.fillStyle=e,a.fillRect(0,0,r,n);e=t.find(".qc-colorpicker-a"),a=e[0].getContext("2d");a.clearRect(0,0,r,n);t=a.createLinearGradient(1,0,e[0].width-1,0),e="rgba("+i.r+","+i.g+","+i.b+", 0)",i="rgba("+i.r+","+i.g+","+i.b+", 1)";t.addColorStop(0,e),t.addColorStop(1,i),a.fillStyle=t,a.fillRect(0,0,r,n)},setPanelPick:function(t){var e=t.find(".qc-colorpicker-panel canvas"),c=t.find(".qc-colorpicker-panel-pick"),a=e[0].width,r=e[0].height,e=t[0].rgba,t=qc.colorpicker.rgba2hsba(e),a=parseInt(t.s*a/100-c.width()/2),r=parseInt((100-t.b)*r/100-c.height()/2);c.css({left:a+"px",top:r+"px","box-shadow":"0 0 2px 2px "+(200<=e.r&&200<=e.g&&200<=e.b?"#000":"#fff")})},setTextBox:function(t){var e=t.find(".qc-colorpicker-cur"),c=t.find(".qc-colorpicker-hex"),a=t.find(".qc-colorpicker-rgb"),t=t[0].rgba;e.css("background",qc.colorpicker.rgba2str(t)),c.val(qc.colorpicker.rgba2str(t,"hex"));var r=[t.r,t.g,t.b];a.each(function(t){qc(this).val(r[t])});t.a,t.a,a.eq(3).val(t.a)},str2rgba:function(a){a=a.replace(/\s+/g,"");var r={r:0,g:0,b:0,a:1};return[/^#([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})?$/i,/^rgb\((\d{0,3}),(\d{0,3}),(\d{0,3})\)$/i,/^rgba\((\d{0,3}),(\d{0,3}),(\d{0,3}),([\d\.]+)\)$/i].each(function(t,e){var c=a.match(t);if(c){t=[c[1],c[2],c[3]].map(function(t){return parseInt(1<e?t:"0x"+(1==t.length?t+t:t))});return r.r=t[0],r.g=t[1],r.b=t[2],c[4]&&(r.a=0==e?parseFloat((parseInt("0x"+c[4])/255).toFixed(2)):c[4]),!1}}),r},rgba2hsba:function(t){var e=t.r,c=t.g,a=t.b,r=0,n=0,i=Math.min(e,c,a),o=Math.max(e,c,a),i=o-i,d=o,r=0!=(n=0!=o?255*i/o:0)?e==o?(c-a)/i:c==o?2+(a-e)/i:4+(e-c)/i:0;return(r*=60)<0&&(r+=360),{h:r,s:n*=100/255,b:d*=100/255,a:t.a}},hsba2rgba:function(t){var e,c,a,r,n=Math.round(t.h),i=Math.round(255*t.s/100),o=Math.round(255*t.b/100);return 0==i?e=c=a=o:(o=n%60*((r=o)-(i=(255-i)*o/255))/60,(n=360==n?0:n)<60?(e=r,c=(a=i)+o):n<120?(a=i,e=(c=r)-o):n<180?(c=r,a=(e=i)+o):n<240?(e=i,c=(a=r)-o):n<300?(a=r,e=(c=i)+o):a=n<360?(c=i,(e=r)-o):c=e=0),{r:Math.round(e),g:Math.round(c),b:Math.round(a),a:t.a}},rgba2str:function(t,e){var c=t.r,a=t.g,r=t.b,t=t.a;if("hex"==e){e="#"+[c,a,r].map(function(t){return("0"+parseInt(t).toString(16)).slice(-2)}).join("");return 1!=t&&(e+=Math.round("0"+255*t).toString(16).slice(-2)),e}r=[c,a,r].join(",");return 1==t?"rgb("+r+")":"rgba("+r+","+t+")"},createList:function(r,t){var n=qc.colorpicker.str2rgba(t);[["#C00000","#ff0000","#FFC000","#ffff00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"],["#FFFFFF","#000000","#E7E6E6","#44546A","#4472C4","#ED7D31","#A5A5A5","#FFC000","#5B9BD5","#70AD47"],["#F2F2F2","#7F7F7F","#D0CECE","#D5DCE4","#D9E2F3","#FBE4D5","#EDEDED","#FFF2CC","#DEEAF6","#E2EFD9"],["#D9D9D9","#595959","#AEAAAA","#ACB9CA","#B4C6E7","#F7CAAC","#DBDBDB","#FFE599","#BDD6EE","#C5E0B3"],["#BFBFBF","#404040","#767171","#8496B0","#8EAADB","#F4B083","#C9C9C9","#FFD966","#9CC2E5","#A8D08D"],["#A6A6A6","#262626","#3B3838","#323E4F","#2F5496","#C45911","#7B7B7B","#BF8F00","#2E74B5","#538135"],["#808080","#0D0D0D","#171717","#222A35","#1F3864","#833C0B","#525252","#806000","#1F4E79","#385623"]].each(function(t,e){var a=qc("<div class='qc-colorpicker-row'>");t.each(function(t,e){var c=qc("<a href='javascript:void(0);' class='qc-colorpicker-box'>");c.css("background-color",t);t=qc.colorpicker.str2rgba(t);t.r==n.r&&t.g==n.g&&t.b==n.b&&1==n.a&&c.addClass("selected"),a.append(c),c.click(function(){var t=qc(this);r.find(".qc-colorpicker-box").removeClass("selected"),t.addClass("selected")})}),r.append(a)})},item:function(t){var e=t.curr.closest("[qc-content]")[0].callee,c=t.curr.css("background-color");e&&c&&(e(c),qc.popfrm.dyHide(t))},confirm:function(t){var e=t.contrl,c=(e[0].origin,e[0].callee),e=e.find("[qc-content]"),e=e[0].rgba?qc.colorpicker.rgba2str(e[0].rgba):e.find(".qc-colorpicker-box.selected").css("background-color");c&&c(e),qc.popfrm.hide(t)}},qc.c.datepicker={control:"datepicker",show:function(t){var a=t.curr,r=a.attr("qc-mode")||"date",n=a.attr("qc-target")?qc(a.attr("qc-target")):a;qc.popfrm.dyShow(qc.lang.datepicker.title,[{name:"ok",fn:"qc.datepicker.confirm"},{name:"cancel",fn:"qc.datepicker.hide"}],"",a,function(t){var e=new Date,c=t.find("[qc-content]");c.css("padding",0),t.addClass("qc-datepicker");t=e,e=a.val();e&&(e=e.replace(/[-\.]/gi,"/"),e=new Date(e),isNaN(e.getTime())||(t=e)),c[0].date=t,c[0].mode=r,c[0].target=n,qc.datepicker.createContent(c),qc.datepicker.format(c),c[0].refresh=qc.datepicker.refresh,c[0].refresh(c)})},createContent:function(t){var e=t[0].mode;["date","datetime"].contains(e)&&(r=qc("<div class='qc-datepicker-bar'>   <div class='qc-datepicker-ymbox'>       <span years qc-fn='qc.datepicker.ymShow'></span>   </div>   <div class='qc-datepicker-buttons'>       <span class='qc-datepicker-up' qc-fn='qc.datepicker.udpick'></span>       <span class='qc-datepicker-down' qc-fn='qc.datepicker.udpick'></span>   </div></div>"),t.append(r),qc.util.icon(r.find(".qc-datepicker-up"),"up"),qc.util.icon(r.find(".qc-datepicker-down"),"down"),r=qc("<div class='qc-datepicker-bar'>   <table class='qc-datepicker-dates'>       <tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>   </table></div>"),t.append(r),r.find("tr").eq(0).find("th").each(function(t){var e=qc.lang.datepicker.weeks;qc(this).html(e[t])}),r.find("td").attr("qc-fn","qc.datepicker.datepick"));var c,a,r=qc("<div class='qc-datepicker-bar times'>");t.append(r),["datetime","time"].contains(e)&&(t=qc("   <span class='qc-datepicker-hour' qc-fn='qc.datepicker.hmsShow'></span> :    <span class='qc-datepicker-minute' qc-fn='qc.datepicker.hmsShow'></span> :    <span class='qc-datepicker-second' qc-fn='qc.datepicker.hmsShow'></span> "),r.append(t)),["datetime","date","time"].contains(e)&&(c=qc(("time"!=e?"   <span class='qc-datepicker-today' qc-fn='qc.datepicker.today'>"+qc.lang.datepicker.today+"</span>":"")+"   <span class='qc-datepicker-cancel' qc-fn='qc.datepicker.cancel'>"+qc.lang.datepicker.cancel+"</span>"),r.append(c)),["date","datetime"].contains(e)&&(a=qc("<div class='qc-datepicker-ympicker'>   <table>       <tr><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td></tr>   </table></div>"),r.before(a),a.find("td").attr("qc-fn","qc.datepicker.ympick")),["datetime","time"].contains(e)&&(c=qc("<div class='qc-datepicker-hpicker'>   <table>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>   </table></div>"),a=qc("<div class='qc-datepicker-mspicker'>   <table>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>   </table></div>"),"time"==e?r.after(c).after(a):r.before(c).before(a),c.find("td").each(function(t){qc(this).attr("qc-fn","qc.datepicker.hmspick").attr("v",t).html(t)}),a.find("td").each(function(t){qc(this).attr("qc-fn","qc.datepicker.hmspick").attr("v",t).html(t)}))},format:function(t){qc.datepicker.formatym(t),qc.datepicker.formatDates(t),qc.datepicker.formatTimes(t),qc.datepicker.layout(t,0)},formatym:function(t){var e,c,a,r=t[0].mode;["date","datetime"].contains(r)&&(r=t[0].date,e=r.getFullYear(),c=r.getMonth(),r=qc.lang.datepicker.years,a=qc.lang.datepicker.months,r=r.split("/").map(function(t){return t.contains("m")?"<span month='"+c+"' qc-fn='qc.datepicker.ymShow'>"+t.replace(/m/,a[c])+"</span>":t.contains("y")?"<span year='"+e+"' qc-fn='qc.datepicker.ymShow'>"+t.replace(/y/,e)+"</span>":void 0}).join(""),(t=t.find(".qc-datepicker-ymbox")).find("[year], [month]").remove(),t.append(r),t.find("[years]").hide(),t.find("[year]").show(),t.find("[month]").show())},formatDates:function(t){var e=t[0].mode;if(["date","datetime"].contains(e)){var e=t[0].date,c=e.getFullYear(),a=e.getMonth(),e=new Date(c,a+1,1);e.setDate(e.getDate()-1);var r=e.getDate(),n=1,i=new Date(c,a,n).getDay();0==i&&(i=7);e=new Date(c,a,1);e.setDate(e.getDate()-1);var o=e.getDate(),e=t.find(".qc-datepicker-dates");e.find("td").removeClass("other");var d=e.find("tr"),l=1;if(1<i){var s,q=i-2,f=c,p=a;for(-1==(p-=1)&&(f--,p=11);1==l;)if((s=d.eq(l).find("td").eq(q)).attr("year",f).attr("month",p).attr("date",o),s.addClass("other").html(o),o--,--q<0)break}for(;n<=r;)(s=d.eq(l).find("td").eq(i-1)).attr("year",c).attr("month",a).attr("date",n),s.html(n),n++,7<++i&&(l++,i=1);for(f=c,p=a,12==(p+=n=1)&&(f++,p=0);l<7;)(s=d.eq(l).find("td").eq(i-1)).attr("year",f).attr("month",p).attr("date",n),s.addClass("other").html(n),n++,7<++i&&(l++,i=1);qc.datepicker.date(t)}},formatTimes:function(t){var e,c,a=t[0].mode;["time","datetime"].contains(a)&&(e=(c=t[0].date).getHours(),a=c.getMinutes(),c=c.getSeconds(),e=("0"+e).slice(-2),a=("0"+a).slice(-2),c=("0"+c).slice(-2),t.find(".qc-datepicker-hour").attr("hour",e).html(e),t.find(".qc-datepicker-minute").attr("minute",a).html(a),t.find(".qc-datepicker-second").attr("second",c).html(c))},date:function(t){var e=t[0].date,c=new Date,a=e.getFullYear(),r=e.getMonth(),e=e.getDate(),t=t.find(".qc-datepicker-dates");t.find("td.picked, td.today").removeClass("picked today"),t.find("td[year='"+a+"'][month='"+r+"'][date='"+e+"']").addClass("picked");c=t.find("td[year='"+c.getFullYear()+"'][month='"+c.getMonth()+"'][date='"+c.getDate()+"']");0<c.length&&c.addClass("today")},refresh:function(t){var e,c,a=t[0].refresh;a&&(e=new Date,null!=(c=t[0].date)&&(c.setHours(e.getHours()),c.setMinutes(e.getMinutes()),c.setSeconds(e.getSeconds()),t[0].date=c,qc.datepicker.formatTimes(t),qc.datepicker.date(t),setTimeout(function(){a(t)},1e3)))},ymShow:function(t){var e=t.curr,c=t.contrl.find("[qc-content]"),a=c.find(".qc-datepicker-ymbox"),r=c.find(".qc-datepicker-ympicker"),n=a.find("[years]"),i=a.find("[year]"),t=a.find("[month]");if(r.isShow())return r.hide(),qc.datepicker.layout(c,0),void qc.datepicker.formatym(c);a=e.attr("year"),e=e.attr("month");t.hide(),a?(i.hide(),n.show(),qc.datepicker.yShow(a,n,r)):e&&(n.hide(),i.show(),qc.datepicker.mShow(e,r)),qc.datepicker.layout(c,1),r.show()},yShow:function(e,t,c){var a=parseInt(e.slice(0,-1)+"0"),r=a-3;t.html(a+"-"+(a+9)).attr("s0",a),c.find("td").each(function(){var t=qc(this).removeClass("picked other");t.removeAttr("month").html(r),t.attr("year",r),(r<a||a+9<r)&&t.addClass("other"),r==parseInt(e)&&t.addClass("picked"),r++})},mShow:function(e,t){var c=0;t.find("td").each(function(){var t=qc(this).removeClass("picked other");t.removeAttr("year"),t.attr("month",c),11<c?(t.addClass("other"),t.html(c+1-12)):t.html(c+1),c==parseInt(e)&&t.addClass("picked"),c++})},ympick:function(t){var e=t.curr,c=t.contrl.find("[qc-content]"),a=c.find(".qc-datepicker-ympicker"),r=e.attr("year"),t=e.attr("month"),e=c[0].date;r?e.setFullYear(r):t&&(e.setFullYear(c.find(".qc-datepicker-ymbox [year]").attr("year")),e.setMonth(t)),c[0].date=e,qc.datepicker.format(c),a.hide()},datepick:function(t){var e=t.curr,c=t.contrl.find("[qc-content]"),a=e.attr("year"),r=e.attr("month"),t=e.attr("date"),e=c[0].date;e.setFullYear(a),e.setMonth(r),e.setDate(t),c[0].date=e,qc.datepicker.date(c)},udpick:function(t){var e,c,a,r=t.curr,n=r.closest("[qc-content]"),i=n.find(".qc-datepicker-ymbox"),o=n.find(".qc-datepicker-ympicker"),d=i.find("[years]"),l=i.find("[year]"),t=i.find("[month]"),i=0;r.is(".qc-datepicker-up")&&(i=-1),r.is(".qc-datepicker-down")&&(i=1),o.isShow()?d.isShow()?(a=parseInt(d.attr("s0"))+10*i,qc.datepicker.yShow(a+"",d,o)):(a=parseInt(l.attr("year"))+i,l.attr("year",a),l.html(l.html().replace(/\d+/gi,a))):(c=e="",qc.lang.datepicker.years.split("/").each(function(t){t.contains("m")?e=t:t.contains("y")&&(c=t)}),a=parseInt(t.attr("month"))+i,(i=n[0].date).setMonth(a),a=(n[0].date=i).getFullYear(),i=i.getMonth(),t.attr("month",i),t.html(e.replace(/m/,qc.lang.datepicker.months[i])),l.attr("year",a),l.html(c.replace(/y/,a)),qc.datepicker.formatDates(n))},today:function(t){t=t.curr.closest("[qc-content]");t[0].date=new Date,qc.datepicker.format(t),t[0].refresh||(t[0].refresh=qc.datepicker.refresh,t[0].refresh(t))},cancel:function(t){t.curr.closest("[qc-content]")[0].date=void 0,qc.datepicker.confirm(t)},hmsShow:function(t){var e=t.curr,c=e.closest("[qc-content]"),a=c[0].date,r=e.attr("hour"),n=e.attr("minute"),e=e.attr("second"),r=r?"hour":n?"minute":e?"second":"",n=c.find(".qc-datepicker-hpicker"),e=c.find(".qc-datepicker-mspicker");if((t="hour"==r?n:e).isShow()&&t.attr("picker")==r)return t.removeAttr("picker"),t.hide(),void qc.datepicker.layout(c,0);n.hide(),e.hide(),"hour"==r?value=a.getHours():"minute"==r?value=a.getMinutes():"second"==r&&(value=a.getSeconds()),null!=value&&(t.find("td.picked").removeClass("picked"),t.find("td[v='"+value+"']").addClass("picked"),t.attr("picker",r).show(),qc.datepicker.layout(c,r))},hmspick:function(t){var e=t.curr,c=e.attr("v"),a=e.closest("[picker]"),r=a.attr("picker"),t=a.closest("[qc-content]"),e=t[0].date;"hour"==r?e.setHours(c):"minute"==r?e.setMinutes(c):"second"==r&&e.setSeconds(c),t[0].date=e,t[0].refresh=void 0,qc.datepicker.formatTimes(t),a.removeAttr("picker"),a.hide(),qc.datepicker.layout(t,0)},confirm:function(t){var e=t.contrl.find("[qc-content]"),c=e[0].target,e=qc.datepicker.formatDate(e[0].date,e[0].mode);null!=c[0].value?c.val(e):c.html(e),c.change(),qc.datepicker.hide(t)},formatDate:function(t,e){if(!t)return"";var c=t.getFullYear(),a=("0"+(t.getMonth()+1)).slice(-2),r=("0"+t.getDate()).slice(-2),n=("0"+t.getHours()).slice(-2),i=("0"+t.getMinutes()).slice(-2),t=("0"+t.getSeconds()).slice(-2);return"datetime"==e?c+"-"+a+"-"+r+" "+n+":"+i+":"+t:"time"==e?n+":"+i+":"+t:c+"-"+a+"-"+r},layout:function(t,e){var c,a,r,n,i,o=t.find(".qc-datepicker-bar"),d=t.find(".qc-datepicker-bar times");1==o.length?n=(i=(d=o.eq(0)).next()).next():(c=o.eq(0),a=o.eq(1),d=o.eq(2),i=(n=(r=o.eq(1).next()).next()).next()),d.find("[hour], [minute], [second]").removeClass("selected"),0==e?(n.hide(),i.hide(),c&&(o.show(),r.hide(),o=a.contents("table"),r.find("table").width(o.width()),r.find("table").height(o.height()),n.find("table").width(o.width()),n.find("table").height(c.height()+a.height()),i.find("table").width(o.width()),i.find("table").height(c.height()+a.height()))):1==e?(n.hide(),i.hide(),d.hide(),c&&(c.show(),a.hide(),r.show())):(d.show(),i.hide(),c&&(c.hide(),a.hide(),r.hide()),"hour"==e?(n.show(),i.hide()):(n.hide(),i.show()),d.find("["+e+"]").addClass("selected"),qc.popfrm.layout(t.closest("[qc-control]")))},hide:function(t){t.contrl.find("[qc-content]")[0].refresh=void 0,qc.popfrm.hide(t)}},qc.c.lister={control:"lister",create:function(t){t.find("[qc-content]").hide(),t.find("[qc-toolbar]").remove(),qc.lister.createBar(t),t.find("ul")[0]||t.append("<ul>");var e=t.attr("qc-fn");e&&(t[0].callback=qc.util.convert2fnc(e));var c=t.attr("qc-page"),e=t.attr("qc-count");c||t.attr("qc-page",1),e||t.attr("qc-count",20)},createBar:function(t){var a,e=t.attr("qc-buttons");e&&(a=qc("<div class='qc-toolbar' qc-toolbar></div>"),t.prepend(a),e.split(",").each(function(t){var e=t.split("|"),c=qc("<a href='javascript:void(0);' qc-type='view'></a>");a.append(c),e[1]&&(t=2<e.length?e.slice(2):[],qc.util.lang(c,e[1],t.join(",")),c.prepend("&nbsp;"),c.attr("qc-type",["view","list"].contains(e[1])?"view":e[1])),e[0]&&qc.util.icon(c,e[0])}))},init:function(){qc.lister.getDatas()},getDatas:function(){qc("[qc-control='lister']").each(function(){var t=qc(this),e=t.attr("qc-mode")||"auto";qc.lister.setView(t,0),"auto"==e&&qc.lister.get(t)})},get:function(t,e,c){(e=e||{}).page=t.attr("qc-page")||1,e.count=t.attr("qc-count")||20,qc.util.get(t,e,function(t,e){e.contrl[0].data=t,qc.lister.fill(t,e,c)})},fill:function(t,e,c){var a,r=e.contrl,n=r.attr("qc-field"),i=r.find("[qc-content]"),o=r.find("[qc-toolbar] a.selected");if(i[0]){a=i.eq(o[0]?o.index():0),o[0]&&(a=i.eq(o.index()));var d=r.find("ul");d.empty();for(var l=0;l<t.rows;l++){var s=t.data[l],q=qc("<li>");qc.lister.content(a,n,q,s),d.append(q)}o=r.attr("qc-for");o&&qc.pagepicker.show(qc(o),r,t.pages);r=c||r[0].callback;r&&"function"==typeof r&&r(t,e)}},content:function(t,e,c,a){var r,n=t.clone(),t=n.attr("class");for(r in c.addClass(t||""),c.attr("qc-field",e),c.attr("qc-value",a[e]),a){var i=n.find("[qc-field='"+r+"']");i[0]&&(null!=i[0].value?i.val(a[r]):i.attr("qc-value",a[r]).html(a[r]))}c.append(n.contents())},setView:function(t,e){e=e||0;t=t.find("[qc-toolbar] a");t.removeClass("selected"),t.eq(e).addClass("selected")},view:function(t){var e=t.curr,c=t.contrl,e=e.index();qc.lister.setView(c,e),t.args={},qc.lister.fill(c[0].data,t)}},qc.c.pagepicker={control:"pagepicker",create:function(t){t.hide(),t.addClass("qc-pagepicker")},show:function(t,e,c){t[0].origin=e,t.empty();var a=e.attr("qc-page")||0,r=e.attr("qc-count")||0,e=t.attr("qc-count")||10;if(0!=a||0!=r){var n=parseInt(a),i=parseInt(e),o=Math.floor((n-1)/i)*i+1;i<n&&qc.pagepicker.setPage(t,o-1,"&lt;",n);for(var d=0;d<i&&!(c<o);d++)qc.pagepicker.setPage(t,o,o,n),o++;o<c&&qc.pagepicker.setPage(t,o,"&gt;",n),t.show()}},setPage:function(t,e,c,a){var r=qc("<li qc-type='page'>");r.attr("qc-value",e).html(c),a==e&&r.addClass("selected"),t.append(r)},page:function(t){var e=qc(t.contrl[0].origin),c=e.attr("qc-control"),c=qc[c];e.attr("qc-page",t.curr.attr("qc-value")),c.get(e)}},qc.c.editor={control:"editor",create:function(t){t[0].mode=QCSet(),t[0].pos="static";var e=t.attr("qc-mode")||"auto";e&&(e.contains("auto")?t[0].mode.add("get","post"):(e.contains("get")&&t[0].mode.add("get"),e.contains("post")&&t[0].mode.add("post")),e.contains("fixed")&&(t[0].pos="fixed",t.css("position","absolute"),t.hide())),t.find("[qc-field]").each(function(){var t=qc(this),e=t.attr("qc-mode");e&&t.bind(e,function(){qc.editor.verify(qc(this))})}),qc.editor.hideMsg(t);e=t.attr("qc-fn");e&&(t[0].callback=qc.util.convert2fnc(e)),t[0].mode.contains("get")&&qc.editor.get(t,{})},show:function(t){var e=qc(t.curr.attr("qc-target")),c={};e[0].orEl=t.curr[0],qc.util.getVal(t.curr,c),qc.editor.get(e,c),"fixed"==e[0].pos&&(e.show(),qc.util.hideObj.set(e))},get:function(t,e,c){e=e||{},qc.util.get(t,e,function(t,e){qc.editor.fill(t,e,c)})},fill:function(t,e,c){var a=e.contrl;if(qc.editor.hideMsg(a),0==t.rows)qc.util.initData(a);else for(var r=0;r<t.rows;r++){var n=t.data[r];qc.util.setDatas(a,n)}c=c||a[0].callback;c&&"function"==typeof c&&c(t,e)},change:function(t,e){var c=t.contrl,a=t.curr,r=!0,t=c.equals(a);t?c.find("[qc-field]").each(function(){var t=qc(this);r=qc.editor.verify(t)&&r}):r=qc.editor.verify(a),r&&(c[0].mode.contains("post")||t)&&qc.editor.post(a,{},e)},submit:function(t,e){t.curr=t.contrl,qc.editor.change(t,e)},post:function(t,e,c){qc.util.post(t,e,function(t,e){qc.editor.fill(t,e,c)})},verify:function(t){var e=[];t.contrl?t.contrl.find("[qc-field]").each(function(){e.push(qc(this))}):e.push(t);var c=!0;return e.each(function(t){var e=t.attr("qc-rule");if(!e)return!0;var n,e=e?e.split(" "):[],i=qc.util.getVal(t),o=!0;e.each(function(t){if("number"==t)o=o&&/^-?[1-9]?\d*(\.\d{0,2})?$/.exec(i);else if("date"==t)try{var e=new Date(i);o=o&&!isNaN(e.getTime())}catch(t){}else if("notnull"==t)o=o&&0<i.length;else if(n=/^maxlen\((\d+)\)$/.exec(t)){for(var c=0,a=0;a<i.length;a++){var r=i.charCodeAt(a);0<=r&&r<=128?c++:c+=2}o=o&&c<=n[1]}else(n=/^format\(([^\)]+)\)$/.exec(t))&&(t=new RegExp(n[1],"gi"),o=o&&t.exec(i))}),qc.editor.showMsg(t,o),c=c&&o}),c},showMsg:function(t,e){var c=qc(t.attr("qc-success")),t=qc(t.attr("qc-failure"));c.hide(),t.hide(),(e?c:t).show()},hideMsg:function(t){t.is("[qc-control]")?t.find("[qc-field]").each(function(){qc(qc(this).attr("qc-success")).hide(),qc(qc(this).attr("qc-failure")).hide()}):(qc(t.attr("qc-success")).hide(),qc(t.attr("qc-failure")).hide())}},qc.c.treeview={control:"treeview",create:function(t){var e=t.attr("qc-mode")||"auto";t[0].mode=e;var c=t.attr("qc-fn");c&&(t[0].callback=qc.util.convert2fnc(c));c=t.find("[qc-content]");c.hide(),t[0].qc_pKey=c.attr("qc-pKey"),t[0].qc_key=c.attr("qc-key"),t[0].qc_val=c.attr("qc-value"),t.attr("qc-get")&&e.contains("auto")&&qc.treeview.get(t)},get:function(t,e,c){(e=e||{})[t[0].qc_pKey]=t[0].qc_val,qc.util.get(t,e,function(t,e){qc.treeview.fill(t,e,c)})},fill:function(t,e,c){var a=e.contrl,r=a.contents("[qc-content]"),n=a.find("[qc-key='"+a[0].qc_val+"']"),i=parseInt(a.attr("qc-levels")),o=(n=!n[0]?a:n).contents("ul").empty(),d=!1;o[0]||(o=qc("<ul>"),n.append(o)),!isNaN(i)&&0<i&&(d=o.parents("ul").length+1==i);for(var l=0;l<t.rows;l++){var s,q=t.data[l];(s=qc("<li>"))[0].limit=d,qc.treeview.content(r,s,q),o.append(s)}r.contents("[qc-type='addNew']")[0]&&(n=n.attr("qc-key")||"",s=qc("<li qc-pKey='"+n+"'>"),qc.treeview.content(r,s),o.append(s));a=c||a[0].callback;a&&"function"==typeof a&&a(t,e)},content:function(t,e,c){var a=t.clone(),r=a.attr("class"),n=t.attr("qc-key"),t=t.attr("qc-pKey");e.addClass(r||""),e.attr("qc-field",n),c?(e.attr("qc-key",c[n]),e.attr("qc-pKey",c[t]),e.append(a.contents()),qc.util.setDatas(e,c),qc.treeview.caretShow(e,"expand")):(a=a.contents("[qc-type='addNew']"))[0]&&(e.append(a),a.removeAttr("qc-type"),a.show())},caretShow:function(t,c){t.contents("[qc-type]").each(function(){var t=qc(this),e=t.attr("qc-type");c.contains(e)?t.show():t.hide()})},expand:function(t){var e=t.contrl,t=t.curr.closest("li");t[0].limit||(e[0].qc_val=t.attr("qc-key"),qc.treeview.get(e,{}),qc.treeview.caretShow(t,"collapse"))},setPKey:function(t){var e=t.contrl,t=t.curr.closest("ul").closest("li");e[0].qc_val=t[0]?t.attr("qc-key"):e.find("[qc-content]").attr("qc-value")},collapse:function(t){var e=t.curr.closest("li");e[0].limit||(e.contents("ul").remove(),qc.treeview.caretShow(e,"expand"),(e=e.parent().closest("li"))[0]?t.contrl[0].qc_val=e.attr("qc-key"):t.contrl[0].qc_val=t.contrl.find("[qc-content]").attr("qc-value"))},reload:function(t,e){var c=t.contrl,t=t.curr.parent().closest("li");t[0]?c[0].qc_val=t.attr("qc-key"):c[0].qc_val=c.find("[qc-content]").attr("qc-value"),qc.treeview.get(c,{},e)}},qc.c.sheet={control:"sheet",create:function(t){var e=t.attr("qc-mode"),c=t.attr("qc-get"),a=t.contents("table");e&&(t[0].multi=e.contains("multiple"),e=e.contains("manual")?"":"auto");var r=t.attr("qc-fn");r&&(t[0].callback=qc.util.convert2fnc(r)),a[0]||(a=qc("<table>"),t.append(a)),a.contents("thead")[0]||a.append("<thead>"),a.contents("tbody")[0]||a.append("<tbody>");var n=qc("<div qc-content>");t.append(n),n.css("height",t.height()+"px"),t.css("height","auto"),qc.sheet.foot(t);r=qc("<div qc-warp>");r.append(a),n.append(r),c&&e.contains("auto")?qc.sheet.get(t,{}):(e=[],qc.sheet.fromat(a,e),qc.sheet.layout(t),qc.sheet.pages({data:e,rows:e.length,count:e.length,pages:1,page:1},t))},foot:function(t){var e=qc("<div class='qc-sheet-foot' qc-foot>");t.append(e);var c=qc("<span class='qc-sheet-page' qc-type='page' v='first'>");qc.util.icon(c,"first","sheet"),qc.util.lang(c,"first","title","sheet"),e.append(c);var a=qc("<span class='qc-sheet-page' qc-type='page' v='left'>");qc.util.icon(a,"left","sheet"),qc.util.lang(a,"left","title","sheet"),e.append(a);var r=qc("<input type='text' class='' v='page' qc-type='change' qc-fn='qc.sheet.page'>");qc.util.lang(r,"page","title","sheet"),e.append(r),e.append("<span>/</span><span v='pages'></span>");t=qc("<span class='qc-sheet-page' qc-type='page' v='right'>");qc.util.icon(t,"right","sheet"),qc.util.lang(t,"right","title","sheet"),e.append(t);c=qc("<span class='qc-sheet-page' qc-type='page' v='last'>");qc.util.icon(c,"last","sheet"),qc.util.lang(c,"last","title","sheet"),e.append(c);a=qc("<span class='total'>"),r=qc("<span v='rows' class='total'>"),t=qc("<span class='total'>"),c=qc("<span v='count' class='total'>");qc.util.lang(a,"rows","html","sheet"),qc.util.lang(t,"total","html","sheet"),e.append(a).append(r).append(t).append(c)},fromat:function(t,e){var o=[];t.find("thead th").each(function(t){var e=qc(this),c=null!=e.attr("qc-fixed")?"fixed":"",t=e.attr("qc-field")||t,e=e.attr("qc-text")||"";o.push({fixed:c,field:t,text:e})}),t.find("tbody tr").each(function(){var i={};qc(this).find("td").each(function(t){var e=qc(this),t=o[t];t.fixed&&e.attr("qc-fixed",""),e.attr("qc-field",t.field);var c=e.attr("qc-value");if(null==c){var a=e.html();if(t.text){var r,n=JSON.parse(text);for(r in n)if(n[r]==a){c=r;break}}e.attr("qc-value",c=c||a)}i[t.field]=c}),e.push(i)})},get:function(t,e,c){(e=e||{}).page=t.attr("qc-page")||1,e.count=t.attr("qc-count")||20,qc.util.get(t,e,function(t,e){qc.sheet.fill(t,e,c)})},fill:function(t,e,c){var a=e.contrl;a.find(".qc-sheet-head-y, .qc-sheet-data-x, .qc-sheet-head-x, .qc-sheet-scroll").remove();var r,n=a.attr("qc-key"),i=a.find("[qc-content] table"),o=a[0].hideField,d=i.find("thead th").show();o&&(r=[],d.each(function(){var t=qc(this),e=t.attr("qc-field");o.contains(e)?t.hide():r.push(t)}),d=r);for(var l=i.find("tbody").empty(),s=0;s<t.rows;s++){var q=t.data[s],f=qc("<tr>");n&&(f.attr("qc-field",n),f.attr("qc-value",q[n])),l.append(f),qc.sheet.fill_tr(f,d,q)}qc.sheet.pages(t,a);var p,a=c||a[0].callback;0!=(p=a?a(t,e):p)&&qc.sheet.layout(e.contrl)},fill_tr:function(t,e,c){for(var a=0;a<e.length;a++){var r=qc(e[a]),n=r.attr("qc-field"),i=null==r.attr("qc-fixed")?"":"qc-fixed",o=r.attr("qc-text"),r=c[n];o&&(r=JSON.parse(o)[r]),t.append("<td qc-field='"+n+"' qc-value='"+c[n]+"' "+i+">"+r+"</td>")}},layout:function(t){var e=t.find("[qc-content]"),c=e.find("[qc-warp]"),a=c.find("table"),r=qc("<div class='qc-sheet-head-y'>"),n=qc("<div class='qc-sheet-data-x'>"),i=qc("<div class='qc-sheet-head-x'>"),o=qc("<div class='qc-sheet-scroll'>"),d=a.width(),l=c.width();a.width(d<l?l:d),e.append(r.append(a.clone())),e.append(n.append(a.clone())),e.append(i.append(a.clone())),e.append(o.append(a.clone())),t[0].warp=c,t[0].thead_y=r,t[0].data_x=n,t[0].thead_x=i,(t[0].scroll=o).off("click").on("click",qc.sheet.selected),o.off("scroll").on("scroll",qc.sheet.scroll)},scroll:function(t){var e=qc(this).closest("[qc-control]")[0];this.st!=this.scrollTop?(this.st=this.scrollTop,e.data_x[0].scrollTop=this.st,e.warp[0].scrollTop=this.st):(this.sl=this.scrollLeft,e.thead_y[0].scrollLeft=this.sl,e.warp[0].scrollLeft=this.sl)},pages:function(t,e){var c=parseInt(e.attr("qc-page"))||1,a=e.find("[qc-foot]"),e=t.pages||1;a.find(".qc-sheet-page").show(),a.find("[v='page']").val(c),a.find("[v='pages']").html(e),1==c&&(a.find("[v='first']").hide(),a.find("[v='left']").hide()),2==c&&a.find("[v='left']").hide(),c==e&&(a.find("[v='last']").hide(),a.find("[v='right']").hide()),c==e-1&&a.find("[v='right']").hide(),t.rows?a.find("[v='rows']").show().html(t.rows):a.find("[v='rows']").hide().html(""),t.count?a.find("[v='count']").show().html(t.count):a.find("[v='count']").hide().html("")},page:function(t){var e=t.curr,c=t.contrl,a=e.attr("v"),r=e.parent(),t=parseInt(r.find("[v='page']").val()),r=parseInt(r.find("[v='pages']").html());"left"==a?c.attr("qc-page",t-1):"right"==a?c.attr("qc-page",t+1):"first"==a?c.attr("qc-page",1):"last"==a?c.attr("qc-page",r):(e.val(t=r<t?r:t),c.attr("qc-page",t)),qc.sheet.get(c,{},c[0].callee)},selected:function(t){var e,c,n,a,r,i,o=t.pageX,d=t.pageY,l=qc(t.target).closest("[qc-control='sheet']");l[0]&&(i=l.find("[qc-warp]"),e=l[0].data_x,a=l.find("td"),c=l[0].multi,a.each(function(){var t=qc(this),e=t.offset().left,c=e+t.width(),a=t.offset().top,r=a+t.height();if(e<=o&&o<=c&&a<=d&&d<=r)return n=t.closest("tr"),!1}),n&&(t=n.index()+1,a=e.find("tr").eq(t),t=n.hasClass("selected"),c?t?(n.removeClass("selected"),a.removeClass("selected")):(n.addClass("selected"),a.addClass("selected")):(i.find("tr").removeClass("selected"),e.find("tr").removeClass("selected"),t||(n.addClass("selected"),a.addClass("selected"))),l.attr("qc-post")&&(r=[],i.find("tr.selected").each(function(){r.push(qc(this).attr("qc-value"))}),i={},qc.util.getFields(n,"",i),i.key=l.attr("qc-key")||"",i.selected=r.join(","),qc.util.post(n,i))))},setHide:function(t){for(var e=[],c=1;c<arguments.length;c++)e.push(arguments[c]);t[0].hideField=e},refresh:function(t){t.find("[qc-foot] input").change()}};
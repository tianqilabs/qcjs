/* ! qcjs (c) 老李 (20390965@qq.com) v0.2.0 */
qc.c={},qc.icon={},qc.lang={},qc.util=qc.c.util={mobile:!1,_starts:[],_initeds:[],init:function(){if(0==arguments.length){qc.util.on();var t,e=[];for(t in qc.c){var c=qc.c[t];qc[t]=c,e.push(c)}qc.util.iconInit(),qc.util.starts(),qc.util.langInit(function(){e.each(function(t){t.create&&(t.control?qc("[qc-control='"+t.control+"']").each(function(){t.create(qc(this))}):t.create())}),qc.util.initeds()})}else for(var a=0;a<arguments.length;a++){var r=qc(arguments[a]);(c=qc.util.convert2fnc("qc."+r.attr("qc-control")+".create"))&&c(r)}},convert2fnc:function(t){var e;try{"string"==typeof t?e=Function("return "+t)():"object"==typeof t&&t.attr("qc-fn")?e=Function("return "+t.attr("qc-fn"))():"function"==typeof t&&(e=t)}catch(t){}return e},fnc:function(t){var e=!0,c="string"==typeof t?t:t.fn,c=qc.util.convert2fnc(c),t="object"==typeof t?{contrl:t.contrl,curr:t.curr,ev:t.ev}:t;return e=c?c(t):e},on:function(){qc.util.isMobile();var t=qc(document);t.on("click",qc.util.event),t.on("change",qc.util.event),qc(window).on("resize",qc.util.resize),qc(window).on("load",qc.util.resize)},addStart:function(t){t&&"function"==typeof t&&qc.util._starts.push(t)},addInited:function(t){t&&"function"==typeof t&&qc.util._initeds.push(t)},starts:function(){qc.util._starts.each(function(t){t()})},initeds:function(){qc.util._initeds.each(function(t,e){t()})},event:function(t){var e=!0;"change"==t.type&&qc.util.getVal(qc(t.target));var c=qc.util.find(qc(t.target),t);return c.fn&&(e=qc.util.fnc(c)),qc.util.hideObj.remove(t),e},find:function(t,e){var c=t.closest("[qc-control]"),a=t,r=a.attr("qc-fn"),i=a.attr("qc-for"),n=e.type.toLowerCase(),t=a.attr("qc-type"),o=QCSet();if("change"==n&&o.add(n),t&&(t=t.trim(),o.add(t.split(/\s+/))),i&&"change"!=n)r="qc."+i+".show";else{for(;0==o.length&&!r&&0!=(a=a.parent()).length;)a.attr("qc-type")&&o.add(a.attr("qc-type")),r=a.attr("qc-fn");0<o.length&&r?r=o.contains(n)?r:"":0<c.length&&0<o.length&&!r&&(("change"!=(i=o[0])||"change"==i&&n==i)&&(r="qc."+c.attr("qc-control")+"."+o[0]))}return{contrl:c,curr:a,fn:r,ev:e}},hideObj:{hides:QCSet(),set:function(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);qc.util.hideObj.hides.add(t)},remove:function(c){qc.util.hideObj.hides.each(function(t){var e=!1;t.each(function(t){t=qc(t);e=e||c.pageX>=t.offset().left&&c.pageX<=t.offset().left+t.width()&&c.pageY>=t.offset().top&&c.pageY<=t.offset().top+t.height()}),e||(qc(t[0]).hide(),qc.util.hideObj.hides.remove(t))})}},resize:function(){qc.util.isMobile()},isMobile:function(){var t,e=!1;e="maxTouchPoints"in navigator?0<navigator.maxTouchPoints:"msMaxTouchPoints"in navigator?0<navigator.msMaxTouchPoints:(t=window.matchMedia&&matchMedia("(pointer:coarse)"))&&"(pointer:coarse)"===t.media?!!t.matches:"orientation"in window||(t=navigator.userAgent,/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(t)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(t)),qc.util.mobile=e},getKeys:function(t,e){return e=e||{},qc.util.getFields(t,"qc-key qc-need",e),e},getFields:function(e,t,c){c=c||{},t?t.split(" ").each(function(t){t=t.trim();t=e.attr(t);t&&t.split(" ").each(function(t){t=t.trime(),qc.util.getVal(e.find("[qc-field='"+t+"']"),c)})}):e.find("[qc-field]").each(function(){qc.util.getVal(qc(this),c)});var a=[],t=c.key;t&&a.push(t);t=e.attr("qc-key");return t&&a.push.apply(a,t.split(" ")),c.key=a.join(","),c},getVal:function(t,e){var c,a=t[0].tagName.toLowerCase(),r=t.attr("type")||a,i=t.attr("qc-field"),a=void 0;return["hidden","text","password","select","textarea"].contains(r)?(a=t.val(),t.attr("qc-value",a)):a=["checkbox","radio"].contains(r)?t.is(":checked")?t.attr("qc-value")||t.val():t.attr("qc-default"):"file"==r?t[0]:(0<(r=t.find("[qc-subfield]")).length&&(c=[],r.each(function(){var t=qc(this).attr("qc-value");c.push(encodeURI(encodeURI(t)))}),t.attr("qc-value",c.join("&"))),t.attr("qc-value")),e&&i&&null!=a&&((t=e[i])?Array.isArray(t)?t.push(a):e[i]=[t,a]:e[i]=a),a},setDatas:function(t,e){for(var c in e)qc.util.setData(t,c,e[c])},setData:function(t,e,c){var a=t.find("[qc-field='"+e+"']");0<a.length&&(a.attr("qc-value",c),a.is("[qc-control='selector']")?qc.selector.val(a,c):a.is("[type='checkbox']")||a.is("[type='radio']")?c==a.attr("qc-default")?a.attr("checked","checked"):a.removeAttr("checked"):(e=a.attr("type"))?["hidden","text","password","select","textarea"].contains(e)&&a.val(c):c.split("&").each(function(t){t=decodeURI(decodeURI(t)),a.append("<span qc-subfield qc-value='"+t+"']>"+t+"</span>")}))},get:function(t,e,c){qc.util.postData("qc-get",t,e,c)},post:function(t,e,c){qc.util.postData("qc-post",t,e,c)},upload:function(t,e,c){qc.util.postData("qc-upload",t,e,c)},postData:function(t,e,c,a){"function"==typeof c&&(a=c,c={});var r,i,n=e,o=n.closest("[qc-control]"),d=o.closest("[qc-control='editor']");"qc-post"!=t&&"qc-upload"!=t||!d.equals(n)?(r=(e=0==d.length?o:d).attr(t),qc.util.getKeys(e,c),qc.util.getVal(n,c)):(r=o.attr(t),qc.util.getFields(d,"",c)),r&&(d=qc.util.convert2fnc(r),i={contrl:o,curr:n,args:c},d?d(i,function(t){qc.util.postBack(t,i,a)}):qc._post(r,c,function(t){qc.util.postBack(t,i,a)}))},postBack:function(t,e,c){try{t=JSON.parse(t)}catch(t){}c&&c(t,e)},setLangDir:function(t){qc.util._langDir=t},getLangDir:function(){return qc.util._langDir},setLangGlobal:function(t){t&&(qc.util._langGlobal=t)},getLangGlobal:function(){return qc.util._langGlobal},setLangName:function(t){qc.util._langName=t},getLangName:function(){return qc.util._langName},langGlobal:function(t){var e;qc.util._langGlobal||(qc.util._langGlobal=qc("html").attr("qc-lang-global")),qc.util._langGlobal?((e=qc.util._langGlobal).match(/.*\.js$/)||(e+=".js"),e=qc.util._langDir+"/"+e,qc.getScript(e,t)):t()},langInit:function(t,e){"function"==typeof t&&(e=t,t=void 0),qc.util._langDir||(qc.util._langDir=qc("html").attr("qc-lang-dir")?qc("html").attr("qc-lang-dir"):"lang"),t&&(qc.util._langName=t),qc.util._langName||(qc.util._langName=qc("html").attr("lang")),qc.util.langGlobal(function(){var t;qc.util._langName?((t=qc.util._langName).match(/.*\.js$/)||(t+=".js"),t=qc.util._langDir+"/"+t,qc.getScript(t,function(){qc.util.langReset(),e&&e()})):e()})},lang:function(e,t,c,a){var r;c=c||"title",a||(r=e.closest("[qc-control]"))[0]&&(a=r.attr("qc-control"));var i,a=qc.lang[a];!a||(i=a[t]||t)&&c.split(",").each(function(t){"html"==(t=t.trim())?e.html(i):e.attr(t,i)})},langReset:function(){qc("[qc-lang]").each(function(){var t=qc(this),e=t.attr("qc-lang"),c=t.attr("qc-lang-name"),a=t.attr("qc-lang-attr");qc.util.lang(t,c,a,e)})},icon:function(t,e,c){var a;c||(a=t.closest("[qc-control]"))[0]&&(c=a.attr("qc-control"));c=qc.icon[c];!c||(e=c[e]||e)&&(qc.iconStyle?t.prepend(qc(qc.iconStyle).addClass(e)):t.addClass(e))},setIconStyle:function(t){qc.iconStyle=t},iconInit:function(){qc.iconStyle||(qc.iconStyle="<i class='fa'>")}},qc(function(){qc.util.init()}),qc.c.popfrm={control:"popfrm",create:function(t){var e,c,a,r,i,n=qc(t);0!=n.length&&(n.hide(),e=n.find("[qc-warp]"),c=n.find("[qc-container]"),a=n.find("[qc-content]"),r=n.attr("qc-buttons"),i=n.attr("qc-title"),t=n.attr("qc-content"),0==e.length&&(e=qc("<div class='qc-warp' qc-warp>"),n.prepend(e)),0==c.length&&(c=qc("<div class='qc-container' qc-container>"),n.append(c)),(r||i)&&qc.popfrm.createToolbar(i,r,c),0==a.length&&(a=qc("<div class='qc-content' qc-content>"),c.append(a)),t&&a.html(t),0==c.find("[qc-buttons] a").length&&e.attr("qc-type","hide"))},show:function(t){var e=t.curr,c=qc(e.attr("qc-target")),a=e.attr("qc-fn");if(c[0])c[0].origin=e,c[0].isHide=!0,c.show(),(a=qc.util.convert2fnc(a))&&a(c),qc.popfrm.layout(c);else{for(var r=e.attr("qc-title"),t=e.attr("qc-buttons"),c=e.contents(),i=e.attr("qc-content")||"",n=c[0];n;)8==n.nodeType&&(i+=n.textContent+"\n"),n=n.nextSibling;qc.popfrm.dyShow(r,t,i,e,a)}},dyShow:function(t,e,c,a,r){var i=qc("<div class='qc-popfrm' qc-control='popfrm'>"),n=qc("<div class='qc-container' qc-container>"),o=qc("<div class='qc-warp' qc-warp>");qc("body").append(i),i.append(o).append(n),0==qc.popfrm.createToolbar(t,e,n)&&o.attr("qc-type","hide");o=qc("<div class='qc-content' qc-content>");n.append(o),"object"==typeof c&&c.src&&(i[0].src=c.src,o.addClass("qc-popfrm-iframe"),o.append("<iframe src='"+c.src+"'>")),"string"==typeof c&&o.append(c),i[0].origin=a,i[0].isHide=!1,i.show(),r&&r(i),qc.popfrm.layout(i)},createToolbar:function(t,e,c){var a=c.find("[qc-toolbar]"),r=0;return(t||e)&&(a[0]||(a=qc("<div class='qc-toolbar' qc-toolbar>"),c.prepend(a)),(c=a.find("[qc-title]"))[0]||(c=qc("<span class='qc-title' qc-title>"),a.append(c)),t=t||qc.lang.popfrm.title,c.html(t),r=qc.popfrm.createButtons(e,a)),r},createButtons:function(t,e){if(!t)return 0;var c,a={cancel:{title:qc.lang.popfrm.cancel,icon:"close",text:"",type:"hide"},ok:{title:qc.lang.popfrm.ok,icon:"ok"}},r=[],i=a.cancel,t="string"==typeof t?t.split(" "):t;return t.each(function(t){var e;"object"==typeof(t="string"==typeof t&&"cancel"!=t?a[t]:t)&&(e=t.name,t=qc._extend(t,a[e]),"cancel"==e?i=t:r.push(t))}),r.push(i),0<r.length&&((c=e.find("[qc-buttons]"))[0]||(c=qc("<div class='qc-buttons' qc-buttons>"),e.append(c),c.empty()),r.each(function(t){var e=qc("<a href='javascript:void(0);'>");c.append(e),e.attr("qc-type",("cancel"!=t.name||!t.fn)&&t.type||""),qc.util.lang(e,t.title,"title"),t.fn&&e.attr("qc-fn",t.fn),t.text&&(qc.util.lang(e,t.text,"html"),e.prepend("&nbsp;")),t.icon&&qc.util.icon(e,t.icon),t.title&&e.attr("title",t.title)})),r.length},hide:function(t){t.contrl[0].isHide?t.contrl.hide():t.contrl.remove()},layout:function(t){var e,c,a,r,i=t[0].origin,n=t[0].ownerDocument.documentElement,o=t.find("[qc-container]"),d=t.find("[qc-warp]"),l=t.find(".qc-popfrm-iframe"),s="absolute";!i||t[0].src?(r=e="5%",a=c="15%"):qc.util.mobile?(s="relative",c=d.height()/2-o.height()/2+"px"):i[0]&&(c=i.offset().top+i.height()-n.scrollTop,e=i.offset().left,c>d.height()/2&&(c=c-o.height()-i.height()),e>d.width()/2&&(e-=o.width()),c+="px",e+="px"),o.css({position:s,top:c||"auto",left:e||"auto",right:r||"auto",bottom:a||"auto"}),l[0]&&l.css("height","calc(100% - "+t.find(".qc-toolbar").outerHeight()+"px")}},qc.c.selector={control:"selector",create:function(t){t=qc(t);0!=t.length&&qc.selector.createBox(t)},createBox:function(e){var c=qc("<div>");if(e[0].getAttributeNames)e[0].getAttributeNames().each(function(t){c.attr(t,e.attr(t))});else for(var t=e[0].attributes,a=0;a<t.length;a++)c.attr(t[a].name,t[a].value);e.before(c),c.addClass("qc-selector"),c.attr("qc-type","show"),qc.selector.initData(c,e);var r=qc("<input type='text' class='qc-selector-text' qc-content readonly>"),i=qc("<a href='javascript:void(0);' class='qc-selector-caret'></a>"),n=qc("<ul qc-selector-list>");c.append(i).append(r).append(n),qc.util.icon(i,"caret");i=c.attr("qc-mode")||"auto";c[0].mode=i.contains("normal")?"":"auto",i.contains("search")&&(r.removeAttr("readonly"),r.change(function(t){return!1}),r.keyup(function(t){qc.selector.search({contrl:c,curr:qc(this),ev:t})})),r.attr("qc-type","show"),n.hide()},initData:function(t,e){var a=[],r=t.attr("qc-field")||"v",i=t.attr("qc-text")||r;e.find("option").each(function(){var t=qc(this),e={};e[r]=t.attr("value");var t=t.text(),c=!0;t.split(",").each(function(t){t=t.trim();t=/^([^=]+)=(.+)$/.exec(t);t&&(e[t[1]]=t[2],c=!1)}),c&&(e[i]=t),a.push(e)}),t[0].data={rows:a.length,data:a},e.remove()},getDatas:function(e){var t,c=e?(t=e.filter("[qc-for]"),e):(t=qc("[qc-control='selector'][qc-for]"),qc("[qc-control='selector']"));t.each(function(){var t=qc(this),e=qc(t.attr("qc-for"));t[0].frEl=e[0],e[0].orEl=t[0]}),c.each(function(){var t;this.orEl||!e&&"auto"!=this.mode||(t=qc(this),qc.selector.getData(t))})},getData:function(e){var t={};e[0].orEl&&qc.util.getVal(qc(e[0].orEl),t),e[0].search&&(t.search_key=e[0].search),e.attr("qc-get")?qc.util.get(e,t,function(t){e[0].data=t,qc.selector.fillData(e)}):qc.selector.fillData(e)},fillData:function(t){var e=t[0].data,c=t.attr("qc-field")||"v",a=(o=t.attr("qc-text")||c).split(" ");(s=t.find("ul")).empty();for(var r=0;r<e.rows;r++){var i=e.data[r],n=[];a.each(function(t){var e=i[t];n.push(null==e?t:e)});var o=n.join(""),d=qc("<li>"+o+"</li>");d.attr("qc-value",i[c]),d.attr("qc-text",o),d.attr("qc-type","select"),s.append(d)}var l=t.attr("qc-default"),s=t.find("li"),l=null==l?s.eq(0):s.filter("[qc-value='"+l+"']");qc.selector.selected({contrl:t,curr:l})},show:function(t){var e=t.contrl.find("ul"),c=(t.contrl.attr("qc-mode"),t.ev&&"keyup"==t.ev.type);"none"!=e.css("display")&&!c?qc("body").click():(e.show(),qc.util.hideObj.set(e,t.contrl),e.css({left:"0px",top:t.contrl.height()+"px","min-width":t.contrl.width()+"px"}),0<(t=e.find("li.selected")).length&&(e[0].scrollTop=t[0].offsetTop))},select:function(t){var e,c,a;a=t.contrl?(e=t.contrl,t):(a=(e=t).attr("qc-default"),c=e.find("li"),{contrl:e,curr:null==a?c.eq(0):c.filter("[qc-value='"+a+"']")}),qc.selector.selected(a);var r=e.find("ul");qc.util.hideObj.hides.each(function(t){t[0].equals(r)&&(r.hide(),qc.util.hideObj.hides.remove(t))}),e[0].search&&!t.ev||qc.selector.post(e)},selected:function(t){var e=t.contrl,c=t.curr,a=0<c.length?c.attr("qc-text"):"",r=0<c.length?c.attr("qc-value"):"";e.find("li").removeClass("selected"),0<c.length&&c.addClass("selected");c=e.find("[qc-content]");!t.ev&&null!=e[0].search||c.val(a),e.attr("qc-value",r)},post:function(e){e.attr("qc-post")?qc.util.post(e,function(t){qc.selector.change(e)}):qc.selector.change(e)},change:function(t){var e=t.attr("qc-for");e&&qc.selector.getData(qc(e));e=t.closest("[qc-control='editor']");0<e.length&&qc.editor.change({contrl:e,curr:t})},search:function(t){var e=t.contrl,c=t.curr.val();e[0].search=c,qc.selector.getData(e),qc.selector.show(t)},val:function(t,e){if(!e)return t.attr("qc-value");t.find("li[qc-value='"+e+"']").click()},text:function(t){return t.find("[qc-content]").val()},addItem:function(t,e,c){var a,r=(t="string"==typeof t?qc(t):t)[0].data,i=r.data;Array.isArray(e)?i=i.concat(e):((a={})[t.attr("qc-field")]=e,a[t.attr("qc-text")]=c,i.push(a)),r.data=i,r.rows=i.length,qc.selector.getDatas(t)},removeItem:function(t,e){var c=[];Array.isArray(e)?c=c.concat(e):c.push(e);var t=t[0].data,a=t.data;c.each(function(t){a.splice(t,1)}),t.rows=a.length}},qc.util.addInited(function(){qc.selector.getDatas()}),qc.c.colorpicker={control:"colorpicker",show:function(t){var e=t.curr,c=e.attr("qc-colorpicker-mode"),a=e.attr("qc-colorpicker-css")||"color",r=e.attr("qc-target")?qc(e.attr("qc-target")):e,t=r.css(a);qc.colorpicker.dyShow(e,t,c,function(t){r.css(a,t)})},dyShow:function(t,e,c,a){qc.popfrm.dyShow(qc.lang.colorpicker.title,[{name:"ok",fn:"qc.colorpicker.confirm"}],"",t,function(t){t[0].callee=a,t.addClass("qc-colorpicker");t=t.find("[qc-content]");qc.colorpicker.createContent(t,e,c,a)})},createContent:function(t,e,c,a){"panel"==(c=c||(qc.util.mobile?"list":"panel"))&&(qc.colorpicker.createPanel(t),qc.colorpicker.init(t,e)),"list"==c&&qc.colorpicker.createList(t,e)},createPanel:function(t){t.css("padding",0),t.append("<div class='qc-colorpicker-panel'>   <canvas width='256' height='126'></canvas>   <div class='qc-colorpicker-panel-pick'></div> </div><div class='qc-colorpicker-bar'>   <div class='qc-colorpicker-cur'></div>   <canvas width='160' height='12' class='qc-colorpicker-color'></canvas>   <div class='qc-colorpicker-bar-pick'></div>    <div style='width: 160px; height: 12px;' class='qc-colorpicker-a-back'></div>   <canvas width='160' height='12' class='qc-colorpicker-a'></canvas>   <div class='qc-colorpicker-bar-pick-a'></div> </div><div class='qc-colorpicker-textbox'>   <div><input type='text' class='qc-colorpicker-hex'></div>   <div>HEX</div>   <div>       <input type='text' class='qc-colorpicker-rgb'>       <input type='text' class='qc-colorpicker-rgb'>       <input type='text' class='qc-colorpicker-rgb'>       <input type='text' class='qc-colorpicker-rgb'>   <div>       <div class='qc-colorpicker-rgb-text'>R</div>       <div class='qc-colorpicker-rgb-text'>G</div>       <div class='qc-colorpicker-rgb-text'>B</div>       <div class='qc-colorpicker-rgb-text'>A</div></div></div>"),t.find(".qc-colorpicker-panel")[0].onselectstart=function(){return!1},t.find(".qc-colorpicker-bar")[0].onselectstart=function(){return!1}},init:function(e,t){qc.colorpicker.drawBar(e),t=t&&"transparent"!=t?t:"rgba(0,0,0,0)",e[0].rgba=qc.colorpicker.str2rgba(t);t=e.find(".qc-colorpicker-panel");qc.colorpicker.event(t,qc.colorpicker.setPanelPickP);t=e.find(".qc-colorpicker-bar");qc.colorpicker.event(t,qc.colorpicker.setBarPickP),e.find(".qc-colorpicker-hex, .qc-colorpicker-rgb").change(function(t){var c;qc(this).is(".qc-colorpicker-hex")&&(e[0].rgba=qc.colorpicker.str2rgba(this.value)),qc(this).is(".qc-colorpicker-rgb")&&(c=[],e.find(".qc-colorpicker-rgb").each(function(t){var e=this.value.trim();0==e.length&&(e=0),c[t]=e}),e[0].rgba.r=c[0],e[0].rgba.g=c[1],e[0].rgba.b=c[2],e[0].rgba.a=c[3]),qc.colorpicker.setBarPick(e),qc.colorpicker.setPanelPick(e),qc.colorpicker.setTextBox(e)}),qc.colorpicker.setBarPick(e),qc.colorpicker.setPanelPick(e),qc.colorpicker.setTextBox(e)},drawBar:function(t){var e=["#f00","#f0f","#00f","#0ff","#0f0","#ff0","#f00"],c=t.find(".qc-colorpicker-color"),a=c.width(),t=c.height(),c=c[0].getContext("2d"),r=c.createLinearGradient(1,0,a-1,0),i=e.length-1;e.each(function(t,e){r.addColorStop(e/i,t)}),c.fillStyle=r,c.fillRect(0,0,a,t)},event:function(a,r){a.on("mousedown",function(t){var e=qc(t.target);function c(t){r(a,t.pageX,t.pageY),t.preventDefault()}(e.hasClass("qc-colorpicker-bar-pick")||e.hasClass("qc-colorpicker-bar-pick-a")||e.hasClass("qc-colorpicker-panel-pick")||e.is("canvas"))&&(a.tar=e,r(a,t.pageX,t.pageY),qc(document).on("mousemove",c,!1),qc(document).on("mouseup mouseleave",function t(e){qc(document).off("mousemove",c,!1);qc(document).off("mouseup",t,!1)},!1))})},setPanelPickP:function(t,e,c){var a=t.find(".qc-colorpicker-panel-pick"),r=e-t.offset().left,i=c-t.offset().top,n=t.find("canvas"),o=n[0].width,d=n[0].height,e=t.closest("[qc-content]"),r=Math.max(0,Math.min(r,o)),i=Math.max(0,Math.min(i,d)),c=e[0].rgba,t=200<=c.r&&200<=c.g&&200<=c.b?"#000":"#fff";a.css({left:r-a.width()/2+"px",top:i-a.height()/2+"px","box-shadow":"0 0 2px 2px "+t});n=n[0].hsba;n.s=100*r/o,n.b=100-100*i/d,n.a=c.a,e[0].rgba=qc.colorpicker.hsba2rgba(n),qc.colorpicker.setTextBox(e)},setBarPickP:function(t,e,c){var a,r=t.tar,i=!1;r.hasClass("qc-colorpicker-color")||r.hasClass("qc-colorpicker-bar-pick")?a=t.find(".qc-colorpicker-bar-pick"):(a=t.find(".qc-colorpicker-bar-pick-a"),i=!0);var n,o=t.find("canvas").eq(i?1:0),r=e-t.offset().left,e=o[0].width,t=t.closest("[qc-content]"),r=Math.max(o[0].offsetLeft,Math.min(r,e+o[0].offsetLeft));a.css({left:r-a.width()/2+"px"}),i?(n=((r-o[0].offsetLeft)/e).toFixed(2),t[0].rgba.a=n=1==(n=0==n?0:n)?1:n):((n=qc.colorpicker.rgba2hsba(t[0].rgba)).h=360-360*(r-o[0].offsetLeft)/e,t[0].rgba=qc.colorpicker.hsba2rgba(n),qc.colorpicker.drawPanel(t,n)),qc.colorpicker.setTextBox(t)},setBarPick:function(t){var e=t.find(".qc-colorpicker-bar-pick"),c=t.find(".qc-colorpicker-bar-pick-a"),a=t.find(".qc-colorpicker-bar canvas"),r=a[0].width,i=a[0].offsetLeft,n=qc.colorpicker.rgba2hsba(t[0].rgba),r=(360-n.h)/360*r+i-e.width()/2,i=a[1].width/255*(255*n.a)+i-c.width()/2;qc.colorpicker.drawPanel(t,n),e.css("left",r+"px"),c.css("left",i+"px")},drawPanel:function(t,e){var c=t.find(".qc-colorpicker-panel canvas"),a=c[0].getContext("2d"),r=c[0].width,i=c[0].height;e.s=100,e.b=100,e.a=1;var n=qc.colorpicker.hsba2rgba(e),o=qc.colorpicker.rgba2str(n);c[0].hsba=e;e=a.createLinearGradient(3,0,r-3,0);e.addColorStop(0,"#fff"),e.addColorStop(1,o),a.fillStyle=e,a.fillRect(0,0,r,i);e=a.createLinearGradient(0,3,0,i-3);e.addColorStop(0,"rgba(0, 0, 0, 0)"),e.addColorStop(1,"rgba(0, 0, 0, 1)"),a.fillStyle=e,a.fillRect(0,0,r,i);e=t.find(".qc-colorpicker-a"),a=e[0].getContext("2d");a.clearRect(0,0,r,i);t=a.createLinearGradient(1,0,e[0].width-1,0),e="rgba("+n.r+","+n.g+","+n.b+", 0)",n="rgba("+n.r+","+n.g+","+n.b+", 1)";t.addColorStop(0,e),t.addColorStop(1,n),a.fillStyle=t,a.fillRect(0,0,r,i)},setPanelPick:function(t){var e=t.find(".qc-colorpicker-panel canvas"),c=t.find(".qc-colorpicker-panel-pick"),a=e[0].width,r=e[0].height,e=t[0].rgba,t=qc.colorpicker.rgba2hsba(e),a=parseInt(t.s*a/100-c.width()/2),r=parseInt((100-t.b)*r/100-c.height()/2);c.css({left:a+"px",top:r+"px","box-shadow":"0 0 2px 2px "+(200<=e.r&&200<=e.g&&200<=e.b?"#000":"#fff")})},setTextBox:function(t){var e=t.find(".qc-colorpicker-cur"),c=t.find(".qc-colorpicker-hex"),a=t.find(".qc-colorpicker-rgb"),t=t[0].rgba;e.css("background",qc.colorpicker.rgba2str(t)),c.val(qc.colorpicker.rgba2str(t,"hex"));var r=[t.r,t.g,t.b];a.each(function(t){qc(this).val(r[t])});t.a,t.a,a.eq(3).val(t.a)},str2rgba:function(a){a=a.replace(/\s+/g,"");var r={r:0,g:0,b:0,a:1};return[/^#([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})?$/i,/^rgb\((\d{0,3}),(\d{0,3}),(\d{0,3})\)$/i,/^rgba\((\d{0,3}),(\d{0,3}),(\d{0,3}),([\d\.]+)\)$/i].each(function(t,e){var c=a.match(t);if(c){t=[c[1],c[2],c[3]].map(function(t){return parseInt(1<e?t:"0x"+(1==t.length?t+t:t))});return r.r=t[0],r.g=t[1],r.b=t[2],c[4]&&(r.a=0==e?parseFloat((parseInt("0x"+c[4])/255).toFixed(2)):c[4]),!1}}),r},rgba2hsba:function(t){var e=t.r,c=t.g,a=t.b,r=0,i=0,n=Math.min(e,c,a),o=Math.max(e,c,a),n=o-n,d=o,r=0!=(i=0!=o?255*n/o:0)?e==o?(c-a)/n:c==o?2+(a-e)/n:4+(e-c)/n:0;return(r*=60)<0&&(r+=360),{h:r,s:i*=100/255,b:d*=100/255,a:t.a}},hsba2rgba:function(t){var e,c,a,r,i=Math.round(t.h),n=Math.round(255*t.s/100),o=Math.round(255*t.b/100);return 0==n?e=c=a=o:(o=i%60*((r=o)-(n=(255-n)*o/255))/60,(i=360==i?0:i)<60?(e=r,c=(a=n)+o):i<120?(a=n,e=(c=r)-o):i<180?(c=r,a=(e=n)+o):i<240?(e=n,c=(a=r)-o):i<300?(a=r,e=(c=n)+o):a=i<360?(c=n,(e=r)-o):c=e=0),{r:Math.round(e),g:Math.round(c),b:Math.round(a),a:t.a}},rgba2str:function(t,e){var c=t.r,a=t.g,r=t.b,t=t.a;if("hex"==e){e="#"+[c,a,r].map(function(t){return("0"+parseInt(t).toString(16)).slice(-2)}).join("");return 1!=t&&(e+=Math.round("0"+255*t).toString(16).slice(-2)),e}r=[c,a,r].join(",");return 1==t?"rgb("+r+")":"rgba("+r+","+t+")"},createList:function(r,t){var i=qc.colorpicker.str2rgba(t);[["#C00000","#ff0000","#FFC000","#ffff00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"],["#FFFFFF","#000000","#E7E6E6","#44546A","#4472C4","#ED7D31","#A5A5A5","#FFC000","#5B9BD5","#70AD47"],["#F2F2F2","#7F7F7F","#D0CECE","#D5DCE4","#D9E2F3","#FBE4D5","#EDEDED","#FFF2CC","#DEEAF6","#E2EFD9"],["#D9D9D9","#595959","#AEAAAA","#ACB9CA","#B4C6E7","#F7CAAC","#DBDBDB","#FFE599","#BDD6EE","#C5E0B3"],["#BFBFBF","#404040","#767171","#8496B0","#8EAADB","#F4B083","#C9C9C9","#FFD966","#9CC2E5","#A8D08D"],["#A6A6A6","#262626","#3B3838","#323E4F","#2F5496","#C45911","#7B7B7B","#BF8F00","#2E74B5","#538135"],["#808080","#0D0D0D","#171717","#222A35","#1F3864","#833C0B","#525252","#806000","#1F4E79","#385623"]].each(function(t,e){var a=qc("<div class='qc-colorpicker-row'>");t.each(function(t,e){var c=qc("<a href='javascript:void(0);' class='qc-colorpicker-box'>");c.css("background-color",t);t=qc.colorpicker.str2rgba(t);t.r==i.r&&t.g==i.g&&t.b==i.b&&1==i.a&&c.addClass("selected"),a.append(c),c.click(function(){var t=qc(this);r.find(".qc-colorpicker-box").removeClass("selected"),t.addClass("selected")})}),r.append(a)})},item:function(t){var e=t.curr.closest("[qc-content]")[0].callee,c=t.curr.css("background-color");e&&c&&(e(c),qc.popfrm.dyHide(t))},confirm:function(t){var e=t.contrl,c=(e[0].origin,e[0].callee),e=e.find("[qc-content]"),e=e[0].rgba?qc.colorpicker.rgba2str(e[0].rgba):e.find(".qc-colorpicker-box.selected").css("background-color");c&&c(e),qc.popfrm.hide(t)}},qc.c.datepicker={control:"datepicker",show:function(t){var a=t.curr,r=a.attr("qc-mode")||"date",i=a.attr("qc-target")?qc(a.attr("qc-target")):a;qc.popfrm.dyShow(qc.lang.datepicker.title,[{name:"ok",fn:"qc.datepicker.confirm"},{name:"cancel",fn:"qc.datepicker.hide"}],"",a,function(t){var e=new Date,c=t.find("[qc-content]");c.css("padding",0),t.addClass("qc-datepicker");t=e,e=a.val();e&&(e=e.replace(/[-\.]/gi,"/"),e=new Date(e),isNaN(e.getTime())||(t=e)),c[0].date=t,c[0].mode=r,c[0].target=i,qc.datepicker.createContent(c),qc.datepicker.format(c),c[0].refresh=qc.datepicker.refresh,c[0].refresh(c)})},createContent:function(t){var e=t[0].mode;["date","datetime"].contains(e)&&(r=qc("<div class='qc-datepicker-bar'>   <div class='qc-datepicker-ymbox'>       <span years qc-fn='qc.datepicker.ymShow'></span>   </div>   <div class='qc-datepicker-buttons'>       <span class='qc-datepicker-up' qc-fn='qc.datepicker.udpick'></span>       <span class='qc-datepicker-down' qc-fn='qc.datepicker.udpick'></span>   </div></div>"),t.append(r),qc.util.icon(r.find(".qc-datepicker-up"),"up"),qc.util.icon(r.find(".qc-datepicker-down"),"down"),r=qc("<div class='qc-datepicker-bar'>   <table class='qc-datepicker-dates'>       <tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>   </table></div>"),t.append(r),r.find("tr").eq(0).find("th").each(function(t){var e=qc.lang.datepicker.weeks;qc(this).html(e[t])}),r.find("td").attr("qc-fn","qc.datepicker.datepick"));var c,a,r=qc("<div class='qc-datepicker-bar times'>");t.append(r),["datetime","time"].contains(e)&&(t=qc("   <span class='qc-datepicker-hour' qc-fn='qc.datepicker.hmsShow'></span> :    <span class='qc-datepicker-minute' qc-fn='qc.datepicker.hmsShow'></span> :    <span class='qc-datepicker-second' qc-fn='qc.datepicker.hmsShow'></span> "),r.append(t)),["datetime","date","time"].contains(e)&&(c=qc(("time"!=e?"   <span class='qc-datepicker-today' qc-fn='qc.datepicker.today'>"+qc.lang.datepicker.today+"</span>":"")+"   <span class='qc-datepicker-cancel' qc-fn='qc.datepicker.cancel'>"+qc.lang.datepicker.cancel+"</span>"),r.append(c)),["date","datetime"].contains(e)&&(a=qc("<div class='qc-datepicker-ympicker'>   <table>       <tr><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td></tr>   </table></div>"),r.before(a),a.find("td").attr("qc-fn","qc.datepicker.ympick")),["datetime","time"].contains(e)&&(c=qc("<div class='qc-datepicker-hpicker'>   <table>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>   </table></div>"),a=qc("<div class='qc-datepicker-mspicker'>   <table>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>   </table></div>"),"time"==e?r.after(c).after(a):r.before(c).before(a),c.find("td").each(function(t){qc(this).attr("qc-fn","qc.datepicker.hmspick").attr("v",t).html(t)}),a.find("td").each(function(t){qc(this).attr("qc-fn","qc.datepicker.hmspick").attr("v",t).html(t)}))},format:function(t){qc.datepicker.formatym(t),qc.datepicker.formatDates(t),qc.datepicker.formatTimes(t),qc.datepicker.layout(t,0)},formatym:function(t){var e,c,a,r=t[0].mode;["date","datetime"].contains(r)&&(r=t[0].date,e=r.getFullYear(),c=r.getMonth(),r=qc.lang.datepicker.years,a=qc.lang.datepicker.months,r=r.split("/").map(function(t){return t.contains("m")?"<span month='"+c+"' qc-fn='qc.datepicker.ymShow'>"+t.replace(/m/,a[c])+"</span>":t.contains("y")?"<span year='"+e+"' qc-fn='qc.datepicker.ymShow'>"+t.replace(/y/,e)+"</span>":void 0}).join(""),(t=t.find(".qc-datepicker-ymbox")).find("[year], [month]").remove(),t.append(r),t.find("[years]").hide(),t.find("[year]").show(),t.find("[month]").show())},formatDates:function(t){var e=t[0].mode;if(["date","datetime"].contains(e)){var e=t[0].date,c=e.getFullYear(),a=e.getMonth(),e=new Date(c,a+1,1);e.setDate(e.getDate()-1);var r=e.getDate(),i=1,n=new Date(c,a,i).getDay();0==n&&(n=7);e=new Date(c,a,1);e.setDate(e.getDate()-1);var o=e.getDate(),e=t.find(".qc-datepicker-dates");e.find("td").removeClass("other");var d=e.find("tr"),l=1;if(1<n){var s,q=n-2,f=c,p=a;for(-1==(p-=1)&&(f--,p=11);1==l;)if((s=d.eq(l).find("td").eq(q)).attr("year",f).attr("month",p).attr("date",o),s.addClass("other").html(o),o--,--q<0)break}for(;i<=r;)(s=d.eq(l).find("td").eq(n-1)).attr("year",c).attr("month",a).attr("date",i),s.html(i),i++,7<++n&&(l++,n=1);for(f=c,p=a,12==(p+=i=1)&&(f++,p=0);l<7;)(s=d.eq(l).find("td").eq(n-1)).attr("year",f).attr("month",p).attr("date",i),s.addClass("other").html(i),i++,7<++n&&(l++,n=1);qc.datepicker.date(t)}},formatTimes:function(t){var e,c,a=t[0].mode;["time","datetime"].contains(a)&&(e=(c=t[0].date).getHours(),a=c.getMinutes(),c=c.getSeconds(),e=("0"+e).slice(-2),a=("0"+a).slice(-2),c=("0"+c).slice(-2),t.find(".qc-datepicker-hour").attr("hour",e).html(e),t.find(".qc-datepicker-minute").attr("minute",a).html(a),t.find(".qc-datepicker-second").attr("second",c).html(c))},date:function(t){var e=t[0].date,c=new Date,a=e.getFullYear(),r=e.getMonth(),e=e.getDate(),t=t.find(".qc-datepicker-dates");t.find("td.picked, td.today").removeClass("picked today"),t.find("td[year='"+a+"'][month='"+r+"'][date='"+e+"']").addClass("picked");c=t.find("td[year='"+c.getFullYear()+"'][month='"+c.getMonth()+"'][date='"+c.getDate()+"']");0<c.length&&c.addClass("today")},refresh:function(t){var e,c,a=t[0].refresh;a&&(e=new Date,null!=(c=t[0].date)&&(c.setHours(e.getHours()),c.setMinutes(e.getMinutes()),c.setSeconds(e.getSeconds()),t[0].date=c,qc.datepicker.formatTimes(t),qc.datepicker.date(t),setTimeout(function(){a(t)},1e3)))},ymShow:function(t){var e=t.curr,c=t.contrl.find("[qc-content]"),a=c.find(".qc-datepicker-ymbox"),r=c.find(".qc-datepicker-ympicker"),i=a.find("[years]"),n=a.find("[year]"),t=a.find("[month]");if(r.isShow())return r.hide(),qc.datepicker.layout(c,0),void qc.datepicker.formatym(c);a=e.attr("year"),e=e.attr("month");t.hide(),a?(n.hide(),i.show(),qc.datepicker.yShow(a,i,r)):e&&(i.hide(),n.show(),qc.datepicker.mShow(e,r)),qc.datepicker.layout(c,1),r.show()},yShow:function(e,t,c){var a=parseInt(e.slice(0,-1)+"0"),r=a-3;t.html(a+"-"+(a+9)).attr("s0",a),c.find("td").each(function(){var t=qc(this).removeClass("picked other");t.removeAttr("month").html(r),t.attr("year",r),(r<a||a+9<r)&&t.addClass("other"),r==parseInt(e)&&t.addClass("picked"),r++})},mShow:function(e,t){var c=0;t.find("td").each(function(){var t=qc(this).removeClass("picked other");t.removeAttr("year"),t.attr("month",c),11<c?(t.addClass("other"),t.html(c+1-12)):t.html(c+1),c==parseInt(e)&&t.addClass("picked"),c++})},ympick:function(t){var e=t.curr,c=t.contrl.find("[qc-content]"),a=c.find(".qc-datepicker-ympicker"),r=e.attr("year"),t=e.attr("month"),e=c[0].date;r?e.setFullYear(r):t&&(e.setFullYear(c.find(".qc-datepicker-ymbox [year]").attr("year")),e.setMonth(t)),c[0].date=e,qc.datepicker.format(c),a.hide()},datepick:function(t){var e=t.curr,c=t.contrl.find("[qc-content]"),a=e.attr("year"),r=e.attr("month"),t=e.attr("date"),e=c[0].date;e.setFullYear(a),e.setMonth(r),e.setDate(t),c[0].date=e,qc.datepicker.date(c)},udpick:function(t){var e,c,a,r=t.curr,i=r.closest("[qc-content]"),n=i.find(".qc-datepicker-ymbox"),o=i.find(".qc-datepicker-ympicker"),d=n.find("[years]"),l=n.find("[year]"),t=n.find("[month]"),n=0;r.is(".qc-datepicker-up")&&(n=-1),r.is(".qc-datepicker-down")&&(n=1),o.isShow()?d.isShow()?(a=parseInt(d.attr("s0"))+10*n,qc.datepicker.yShow(a+"",d,o)):(a=parseInt(l.attr("year"))+n,l.attr("year",a),l.html(l.html().replace(/\d+/gi,a))):(c=e="",qc.lang.datepicker.years.split("/").each(function(t){t.contains("m")?e=t:t.contains("y")&&(c=t)}),a=parseInt(t.attr("month"))+n,(n=i[0].date).setMonth(a),a=(i[0].date=n).getFullYear(),n=n.getMonth(),t.attr("month",n),t.html(e.replace(/m/,qc.lang.datepicker.months[n])),l.attr("year",a),l.html(c.replace(/y/,a)),qc.datepicker.formatDates(i))},today:function(t){t=t.curr.closest("[qc-content]");t[0].date=new Date,qc.datepicker.format(t),t[0].refresh||(t[0].refresh=qc.datepicker.refresh,t[0].refresh(t))},cancel:function(t){t.curr.closest("[qc-content]")[0].date=void 0,qc.datepicker.confirm(t)},hmsShow:function(t){var e=t.curr,c=e.closest("[qc-content]"),a=c[0].date,r=e.attr("hour"),i=e.attr("minute"),e=e.attr("second"),r=r?"hour":i?"minute":e?"second":"",i=c.find(".qc-datepicker-hpicker"),e=c.find(".qc-datepicker-mspicker");if((t="hour"==r?i:e).isShow()&&t.attr("picker")==r)return t.removeAttr("picker"),t.hide(),void qc.datepicker.layout(c,0);i.hide(),e.hide(),"hour"==r?value=a.getHours():"minute"==r?value=a.getMinutes():"second"==r&&(value=a.getSeconds()),null!=value&&(t.find("td.picked").removeClass("picked"),t.find("td[v='"+value+"']").addClass("picked"),t.attr("picker",r).show(),qc.datepicker.layout(c,r))},hmspick:function(t){var e=t.curr,c=e.attr("v"),a=e.closest("[picker]"),r=a.attr("picker"),t=a.closest("[qc-content]"),e=t[0].date;"hour"==r?e.setHours(c):"minute"==r?e.setMinutes(c):"second"==r&&e.setSeconds(c),t[0].date=e,t[0].refresh=void 0,qc.datepicker.formatTimes(t),a.removeAttr("picker"),a.hide(),qc.datepicker.layout(t,0)},confirm:function(t){var e=t.contrl.find("[qc-content]"),c=e[0].target,e=qc.datepicker.formatDate(e[0].date,e[0].mode);null!=c[0].value?c.val(e):c.html(e),c.change(),qc.datepicker.hide(t)},formatDate:function(t,e){if(!t)return"";var c=t.getFullYear(),a=("0"+(t.getMonth()+1)).slice(-2),r=("0"+t.getDate()).slice(-2),i=("0"+t.getHours()).slice(-2),n=("0"+t.getMinutes()).slice(-2),t=("0"+t.getSeconds()).slice(-2);return"datetime"==e?c+"-"+a+"-"+r+" "+i+":"+n+":"+t:"time"==e?i+":"+n+":"+t:c+"-"+a+"-"+r},layout:function(t,e){var c,a,r,i,n,o=t.find(".qc-datepicker-bar"),d=t.find(".qc-datepicker-bar times");1==o.length?i=(n=(d=o.eq(0)).next()).next():(c=o.eq(0),a=o.eq(1),d=o.eq(2),n=(i=(r=o.eq(1).next()).next()).next()),d.find("[hour], [minute], [second]").removeClass("selected"),0==e?(i.hide(),n.hide(),c&&(o.show(),r.hide(),o=a.contents("table"),r.find("table").width(o.width()),r.find("table").height(o.height()),i.find("table").width(o.width()),i.find("table").height(c.height()+a.height()),n.find("table").width(o.width()),n.find("table").height(c.height()+a.height()))):1==e?(i.hide(),n.hide(),d.hide(),c&&(c.show(),a.hide(),r.show())):(d.show(),n.hide(),c&&(c.hide(),a.hide(),r.hide()),"hour"==e?(i.show(),n.hide()):(i.hide(),n.show()),d.find("["+e+"]").addClass("selected"),qc.popfrm.layout(t.closest("[qc-control]")))},hide:function(t){t.contrl.find("[qc-content]")[0].refresh=void 0,qc.popfrm.hide(t)}},qc.c.lister={control:"lister",create:function(t){t.find("[qc-content]").hide(),t.find("[qc-toolbar]").remove(),qc.lister.createBar(t),t.find("ul")[0]||t.append("<ul>");var e=t.attr("qc-page"),c=t.attr("qc-count");e||t.attr("qc-page",1),c||t.attr("qc-count",20)},createBar:function(t){var a,e=t.attr("qc-buttons");e&&(a=qc("<div class='qc-toolbar' qc-toolbar></div>"),t.prepend(a),e.split(" ").each(function(t){var e=t.split("|"),c=qc("<a href='javascript:void(0);' qc-type='view'></a>");a.append(c),e[1]&&(t=2<e.length?e.slice(2):[],qc.util.lang(c,e[1],t.join(",")),c.prepend("&nbsp;")),e[0]&&qc.util.icon(c,e[0])}))},getDatas:function(){qc("[qc-control='lister']").each(function(){qc.lister.setView(qc(this),0),qc.lister.get(qc(this))})},get:function(t,e,c){(e=e||{}).page=t.attr("qc-page"),e.count=t.attr("qc-count"),qc.util.get(t,e,function(t,e){e.contrl[0].data=t,qc.lister.fill(t,e,c)})},fill:function(t,e,c){var a,r=e.contrl,i=r.find("[qc-content]"),n=r.find("[qc-toolbar] a.selected");if(i[0]){a=i.eq(n[0]?n.index():0),n[0]&&(a=i.eq(n.index()));var o=r.find("ul");o.empty();for(var d=0;d<t.rows;d++){var l=t.data[d],s=qc("<li>");qc.lister.content(a,s,l),o.append(s)}n=r.attr("qc-for");n&&qc.pagepicker.show(qc(n),r,t.pages),c&&c(t,e)}},content:function(t,e,c){var a,r=t.clone(),t=r.attr("class");for(a in e.addClass(t||""),c){var i=r.find("[qc-field='"+a+"']");i[0]&&i.attr("qc-value",c[a]).html(c[a])}e.append(r.contents())},setView:function(t,e){e=e||0;t=t.find("[qc-toolbar] a");t.removeClass("selected"),t.eq(e).addClass("selected")},view:function(t){var e=t.curr,c=t.contrl,e=e.index();qc.lister.setView(c,e),t.args={},qc.lister.fill(c[0].data,t)},item:function(c){var t=c.contrl;qc.util.post(t,args,function(t,e){qc.lister.showMsg(c.curr,e)})},showMsg:function(t,e){var c=qc(t.attr("qc-success")),a=qc(t.attr("qc-failure"));c.hide(),a.hide(),(e?c:a).show(),qc.util.hideObj.set(c,t)}},qc.util.addInited(function(){qc.lister.getDatas()}),qc.c.pagepicker={control:"pagepicker",create:function(t){t.hide(),t.addClass("qc-pagepicker")},show:function(t,e,c){t[0].origin=e,t.empty();var a=e.attr("qc-page")||1,r=e.attr("qc-count")||20,e=t.attr("qc-count")||10,i=parseInt(a),n=(parseInt(r),parseInt(e)),o=Math.floor((i-1)/n)*n+1;n<i&&qc.pagepicker.setPage(t,o-1,"&lt;",i);for(var d=0;d<n&&!(c<o);d++)qc.pagepicker.setPage(t,o,o,i),o++;o<c&&qc.pagepicker.setPage(t,o,"&gt;",i),t.show()},setPage:function(t,e,c,a){var r=qc("<li qc-type='page'>");r.attr("qc-value",e).html(c),a==e&&r.addClass("selected"),t.append(r)},page:function(t){var e=qc(t.contrl[0].origin),c=e.attr("qc-control"),c=qc[c];e.attr("qc-page",t.curr.attr("qc-value")),c.get(e)}},qc.c.editor={control:"editor",create:function(t){t[0].edit="auto",t[0].pos="static";var e=t.attr("qc-mode");e&&(e.contains("normal")&&(t[0].edit=""),e.contains("fixed")&&(t[0].pos="fixed",t.css("position","absolute"),t.hide())),t.find("[qc-field]").each(function(){var t=qc(this),e=t.attr("qc-mode");e&&t.bind(e,function(){qc.editor.verify(qc(this))})}),qc.editor.hideMsg(t)},show:function(t){var e=qc(t.curr.attr("qc-target")),c={};e[0].orEl=t.curr[0],qc.util.getVal(t.curr,c),qc.editor.get(e,c),"fixed"==e[0].pos&&(e.show(),qc.util.hideObj.set(e))},get:function(t,e,c){qc.util.get(t,e,function(t,e){qc.editor.fill(t,e,c)})},fill:function(t,e,c){var a=e.contrl;qc.editor.hideMsg(a);for(var r=0;r<t.rows;r++){var i=t.data[r];qc.util.setDatas(a,i)}c&&c(t,e)},change:function(t,e){var c=t.contrl,a=t.curr,r=!0,t=c.equals(a);t?c.find("[qc-field]").each(function(){var t=qc(this);r=qc.editor.verify(t)&&r}):r=qc.editor.verify(a),r&&("auto"!=c[0].edit&&!t||qc.editor.post(a,{},e))},submit:function(t,e){t.curr=t.contrl,qc.editor.change(t,e)},post:function(t,e,c){qc.util.post(t,e,function(t,e){qc.editor.fill(t,e,c)})},verify:function(t){var e=[];t.contrl?t.contrl.find("[qc-field]").each(function(){e.push(qc(this))}):e.push(t);var i=!0;return e.each(function(t){var e=t.attr("qc-rule");if(!e)return!0;var c,e=e?e.split(" "):[],a=qc.util.getVal(t),r=!1;e.each(function(t){if("number"==t)r=/^-?\d+(\.\d+)?$/.exec(a);else if("date"==t)try{var e=new Date(a);r=!isNaN(e.getTime())}catch(t){}else"notnull"==t?r=0<a.length:(c=/^maxlen\((\d+)\)$/.exec(t))?r=a.length<=c[1]:(c=/^format\(([^\)]+)\)$/.exec(t))&&(t=new RegExp(c[1],"gi"),r=t.exec(a))}),qc.editor.showMsg(t,r),i=i&&r}),i},showMsg:function(t,e){var c=qc(t.attr("qc-success")),t=qc(t.attr("qc-failure"));c.hide(),t.hide(),(e?c:t).show()},hideMsg:function(t){t.is("[qc-control]")?t.find("[qc-field]").each(function(){qc(qc(this).attr("qc-success")).hide(),qc(qc(this).attr("qc-failure")).hide()}):(qc(t.attr("qc-success")).hide(),qc(t.attr("qc-failure")).hide())}};